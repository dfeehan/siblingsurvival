<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>attributes.to.long — attributes.to.long • siblingsurvival</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="attributes.to.long — attributes.to.long"><meta name="description" content="Start with a wide-form dataframe reported about alters using network method
questions and convert it into a long-form dataset. For example, after a network
survey of out-migrants, there might be variables about sex and age of each emigre
reported to be connected to each respondent. In a study that encountered
a maximum of 3 reported emigres across all respondents, this wide-form
dataframe might look like:
resp.idresp.d.hatemage.1emage.2emage.3emsex.1emsex.2emsex.31
10024NANAMNANA2110
NANANANANANA314033

The attributes.to.long function could convert that into a
long-form dataframe that looks like this:
degreeagesex
10024M
14033F
14023M
14053F
...

(Note that we make no guarantees about the order in which the reshaped data
will be returned.)"><meta property="og:description" content="Start with a wide-form dataframe reported about alters using network method
questions and convert it into a long-form dataset. For example, after a network
survey of out-migrants, there might be variables about sex and age of each emigre
reported to be connected to each respondent. In a study that encountered
a maximum of 3 reported emigres across all respondents, this wide-form
dataframe might look like:
resp.idresp.d.hatemage.1emage.2emage.3emsex.1emsex.2emsex.31
10024NANAMNANA2110
NANANANANANA314033

The attributes.to.long function could convert that into a
long-form dataframe that looks like this:
degreeagesex
10024M
14033F
14023M
14053F
...

(Note that we make no guarantees about the order in which the reshaped data
will be returned.)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">siblingsurvival</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/maternal-estimates.html">Estimating maternal mortality rates from sibling history data</a></li>
    <li><a class="dropdown-item" href="../articles/preparing-data.html">Preparing DHS data</a></li>
    <li><a class="dropdown-item" href="../articles/sibling-estimates.html">Estimating death rates from sibling history data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>attributes.to.long</h1>

      <div class="d-none name"><code>attributes.to.long.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Start with a wide-form dataframe reported about alters using network method
questions and convert it into a long-form dataset. For example, after a network
survey of out-migrants, there might be variables about sex and age of each emigre
reported to be connected to each respondent. In a study that encountered
a maximum of 3 reported emigres across all respondents, this wide-form
dataframe might look like:<br></p><table class="table table"><tr><td>resp.id</td><td>resp.d.hat</td><td>emage.1</td><td>emage.2</td><td>emage.3</td><td>emsex.1</td><td>emsex.2</td><td>emsex.3</td><td>1</td></tr><tr><td>100</td><td>24</td><td>NA</td><td>NA</td><td>M</td><td>NA</td><td>NA</td><td>2</td><td>110</td></tr><tr><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>3</td><td>140</td><td>33</td></tr></table><p>The <code>attributes.to.long</code> function could convert that into a
long-form dataframe that looks like this:<br></p><table class="table table"><tr><td>degree</td><td>age</td><td>sex</td></tr><tr><td>100</td><td>24</td><td>M</td></tr><tr><td>140</td><td>33</td><td>F</td></tr><tr><td>140</td><td>23</td><td>M</td></tr><tr><td>140</td><td>53</td><td>F</td></tr><tr><td></td><td>...</td><td></td></tr></table><p>(Note that we make no guarantees about the order in which the reshaped data
will be returned.)<br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">attributes.to.long</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">attribute.prefix</span>,</span>
<span>  ego.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep.na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\\.|_"</span>,</span>
<span>  varname.first <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>the wide-form dataset to convert</p></dd>


<dt id="arg-attribute-prefix">attribute.prefix<a class="anchor" aria-label="anchor" href="#arg-attribute-prefix"></a></dt>
<dd><p>a vector whose entries have the prefixes of the
names of variables
in the dataframe <code>data</code> that pertain to each
alter. if you'd like these to be re-named in the long
form data, then the variable names you'd like to use
in the long form should be the names of each entry in
this vector. in the example above, we would use
<code>attribute.prefix=c("age"="emage",
                        "sex"="emsex")</code>.
see <code>regexp</code>, below, to understand
how these prefixes are used to match columns of the
dataset; by default, we assume that the variables
match <prefix>&lt;either '.' or '_'&gt;<number>.</number></prefix></p></dd>


<dt id="arg-ego-vars">ego.vars<a class="anchor" aria-label="anchor" href="#arg-ego-vars"></a></dt>
<dd><p>if not NULL, the names of columns in the dataset that refer
to the egos and so should not be converted to long-form. you
can specify that they should be renamed in the same way as with
<code>attribute.prefix</code>. in the example above, we would use
<code>ego.vars=c("degree"="resp.d.hat")</code>.</p></dd>


<dt id="arg-keep-na">keep.na<a class="anchor" aria-label="anchor" href="#arg-keep-na"></a></dt>
<dd><p>if FALSE, remove columns in the resulting dataset that are
all NAs</p></dd>


<dt id="arg-idvar">idvar<a class="anchor" aria-label="anchor" href="#arg-idvar"></a></dt>
<dd><p>the index or name of the variable in the data that has the
respondent id. if NULL, then new ids which correspond to the rows
in data are created.</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>a regular expression that the wide-form variable names are split
around. (eg, for "var_01", sep="_"; for "var.01" is is "\.")</p></dd>


<dt id="arg-varname-first">varname.first<a class="anchor" aria-label="anchor" href="#arg-varname-first"></a></dt>
<dd><p>TRUE if the text before the separator is the variable name
(eg var_01), and FALSE otherwise</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a long-form dataframe with the attributes reported for all of the alters.
the dataframe will include an alter.id variable which is formed using
<respondent id>.<alter number></alter></respondent></p>
    </div>
    <div class="section level2">
    <h2 id="todo">TODO<a class="anchor" aria-label="anchor" href="#todo"></a></h2>


<ul><li><p>should follow the se / nse pattern in, eg, the kp functions;
interim workaround – eg as.data.frame(df),idvar – for now</p></li>
<li><p>for now, this converts any factors into characters.
this is obviously not ideal. eventually, data type should be
preserved...</p></li>
<li><p>handle the case of "" more effectively. Right now, we
<em>assume</em> that all structural missings
(eg, I only report one alter,
though there are three columns for me to do so) are NA</p></li>
<li><p>look at the code in the middle of the function that's
commented out and be sure we know that the order of
the rows will be the same, to that we can cbind them
together.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="co">## TODO add example</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dennis M. Feehan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

