<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>attributes.to.long — attributes.to.long • siblingsurvival</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="attributes.to.long — attributes.to.long" />
<meta property="og:description" content="Start with a wide-form dataframe reported about alters using network method
questions and convert it into a long-form dataset. For example, after a network
survey of out-migrants, there might be variables about sex and age of each emigre
reported to be connected to each respondent. In a study that encountered
a maximum of 3 reported emigres across all respondents, this wide-form
dataframe might look like:
resp.idresp.d.hatemage.1emage.2emage.3emsex.1emsex.2emsex.31
10024NANAMNANA2110
NANANANANANA314033

The attributes.to.long function could convert that into a
long-form dataframe that looks like this:
degreeagesex
10024M
14033F
14023M
14053F
...

(Note that we make no guarantees about the order in which the reshaped data
will be returned.)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-56MJYKC8R7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-56MJYKC8R7');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">siblingsurvival</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/preparing-data.html">Preparing DHS data</a>
    </li>
    <li>
      <a href="../articles/sibling-estimates.html">Estimating death rates from sibling history data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>attributes.to.long</h1>
    
    <div class="hidden name"><code>attributes.to.long.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Start with a wide-form dataframe reported about alters using network method
questions and convert it into a long-form dataset. For example, after a network
survey of out-migrants, there might be variables about sex and age of each emigre
reported to be connected to each respondent. In a study that encountered
a maximum of 3 reported emigres across all respondents, this wide-form
dataframe might look like:<br /></p><table class='table'>
<tr><td>resp.id</td><td>resp.d.hat</td><td>emage.1</td><td>emage.2</td><td>emage.3</td><td>emsex.1</td><td>emsex.2</td><td>emsex.3</td><td>1</td></tr>
<tr><td>100</td><td>24</td><td>NA</td><td>NA</td><td>M</td><td>NA</td><td>NA</td><td>2</td><td>110</td></tr>
<tr><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>3</td><td>140</td><td>33</td></tr>
</table>
<p>The <code>attributes.to.long</code> function could convert that into a
long-form dataframe that looks like this:<br /></p><table class='table'>
<tr><td>degree</td><td>age</td><td>sex</td></tr>
<tr><td>100</td><td>24</td><td>M</td></tr>
<tr><td>140</td><td>33</td><td>F</td></tr>
<tr><td>140</td><td>23</td><td>M</td></tr>
<tr><td>140</td><td>53</td><td>F</td></tr>
<tr><td></td><td>...</td><td></td></tr>
</table>
<p>(Note that we make no guarantees about the order in which the reshaped data
will be returned.)<br /></p>
    </div>

    <pre class="usage"><span class='fu'>attributes.to.long</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>attribute.prefix</span>,
  ego.vars <span class='op'>=</span> <span class='cn'>NULL</span>,
  keep.na <span class='op'>=</span> <span class='cn'>FALSE</span>,
  idvar <span class='op'>=</span> <span class='cn'>NULL</span>,
  sep <span class='op'>=</span> <span class='st'>"\\.|_"</span>,
  varname.first <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>the wide-form dataset to convert</p></td>
    </tr>
    <tr>
      <th>attribute.prefix</th>
      <td><p>a vector whose entries have the prefixes of the
names of variables
in the dataframe <code>data</code> that pertain to each
alter. if you'd like these to be re-named in the long
form data, then the variable names you'd like to use
in the long form should be the names of each entry in
this vector. in the example above, we would use
<code>attribute.prefix=c("age"="emage",
                        "sex"="emsex")</code>.
see <code>regexp</code>, below, to understand
how these prefixes are used to match columns of the
dataset; by default, we assume that the variables
match &lt;prefix&gt;&lt;either '.' or '_'&gt;&lt;number&gt;.</p></td>
    </tr>
    <tr>
      <th>ego.vars</th>
      <td><p>if not NULL, the names of columns in the dataset that refer
to the egos and so should not be converted to long-form. you
can specify that they should be renamed in the same way as with
<code>attribute.prefix</code>. in the example above, we would use
<code>ego.vars=c("degree"="resp.d.hat")</code>.</p></td>
    </tr>
    <tr>
      <th>keep.na</th>
      <td><p>if FALSE, remove columns in the resulting dataset that are
all NAs</p></td>
    </tr>
    <tr>
      <th>idvar</th>
      <td><p>the index or name of the variable in the data that has the
respondent id. if NULL, then new ids which correspond to the rows
in data are created.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>a regular expression that the wide-form variable names are split
around. (eg, for "var_01", sep="_"; for "var.01" is is "\.")</p></td>
    </tr>
    <tr>
      <th>varname.first</th>
      <td><p>TRUE if the text before the separator is the variable name
(eg var_01), and FALSE otherwise</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a long-form dataframe with the attributes reported for all of the alters.
the dataframe will include an alter.id variable which is formed using
&lt;respondent id&gt;.&lt;alter number&gt;</p>
    <h2 class="hasAnchor" id="todo"><a class="anchor" href="#todo"></a>TODO</h2>

    

<ul>
<li><p>should follow the se / nse pattern in, eg, the kp functions;
interim workaround -- eg as.data.frame(df),idvar -- for now</p></li>
<li><p>for now, this converts any factors into characters.
this is obviously not ideal. eventually, data type should be
preserved...</p></li>
<li><p>handle the case of "" more effectively. Right now, we
<em>assume</em> that all structural missings
(eg, I only report one alter,
though there are three columns for me to do so) are NA</p></li>
<li><p>look at the code in the middle of the function that's
commented out and be sure we know that the order of
the rows will be the same, to that we can cbind them
together.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='co'>## TODO add example</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dennis M. Feehan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


