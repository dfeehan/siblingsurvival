[{"path":"http://dennisfeehan.org/siblingsurvival/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2019 Dennis M. Feehan Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Estimating maternal mortality rates from sibling history data","text":"vignette shows use siblingsurvival package estimate quantities related maternal mortality. might find helpful also read vignette estimating mortality rates; much material based vignette. fact, process estimating maternal mortality rates similar estimating -cause death rates, modifications explain vignette. helpful define important terms start analysis: ego - ego survey respondent cell - cell generic group wish produce estimates. Usually, cell defined time period, age range, sex. , example, cell might women age 30-34 2015. overview, ’ll start survey dataset, one provided DHS. use prep_dhs_sib_histories produce two datasets: one dataset row survey respondent/ego one dataset row sibling reported survey respondent ’ll calculate estimates sibling histories three main steps: Create esc dataset, called row ego X sibling X cell Aggregate esc dataset ec dataset, row reports made ego cell Aggregate ec dataset estimates death rates, using either individual aggregate visibility approach ()","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"opening-up-the-demo-datasets","dir":"Articles","previous_headings":"Overview","what":"Opening up the demo datasets","title":"Estimating maternal mortality rates from sibling history data","text":"’ll start opening demonstration DHS dataset.","code":"data(model_dhs_dat)"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"using-prep_dhs_sib_histories-to-get-ego-and-sib-datasets","dir":"Articles","previous_headings":"Overview","what":"Using prep_dhs_sib_histories to get ego and sib datasets","title":"Estimating maternal mortality rates from sibling history data","text":"Now ’ll use prep_dhs_sib_histories ready sibling histories analysis. (Please see Preparing Data vignette details.) step produce two datasets: one row survey respondent/ego; one row reported sibling. Note include parameter add_maternal=TRUE indicate want columns related maternal/pregnancy-related mortality added. Let’s take look datasets ’ve produced. First, ’s dataset information survey respondents. (’ll refer survey respondents ‘ego’): ’s long-form version sibling history data – ’s one row reported sibling.","code":"prepped <- prep_dhs_sib_histories(model_dhs_dat,                                   varmap = sibhist_varmap_dhs6,                                   add_maternal = TRUE,                                   keep_missing = FALSE) #>  #> No information on respondent sex given; assuming all respondents are female. #>  #> Found wwgt column; assuming we have a DHS survey and scaling weights. #> Adding pregnancy-related/maternal death info #> ...sib.died.accident column not found; only pregnancy-related deaths can be identified here #> 638 out of 35082 (1.82%) reports about sibs have unknown survival status. #> 602 out of 35082 (1.72%) reports about sibs have unknown sex. #> Removing reported sibs missing survival status or sex. #> ... this removes  642  out of  35082  ( 1.83 %)  sibling reports.  # we'll only keep the variable we will need for this analysis ex.ego <- prepped$ego.dat %>%   ## add a 'sex' variable   mutate(sex = 'f') %>%   select(caseid,           psu,           stratum_analysis,           stratum_design,           cluster,           age.cat, sex, wwgt) ex.sib <- prepped$sib.dat glimpse(ex.ego) #> Rows: 8,348 #> Columns: 8 #> $ caseid           <chr> \"        1  1  2\", \"        1  3  2\", \"        1  4  … #> $ psu              <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,… #> $ stratum_analysis <dbl> 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 2… #> $ stratum_design   <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,… #> $ cluster          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,… #> $ age.cat          <fct> \"[30,35)\", \"[20,25)\", \"[40,45)\", \"[25,30)\", \"[25,30)\"… #> $ sex              <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\"… #> $ wwgt             <dbl> 1.057703, 1.057703, 1.057703, 1.057703, 1.057703, 1.0… glimpse(ex.sib) #> Rows: 34,440 #> Columns: 27 #> $ .tmpid                      <chr> \"        1  1  2\", \"        1  3  2\", \"   … #> $ caseid                      <chr> \"        1  1  2\", \"        1  3  2\", \"   … #> $ wwgt                        <dbl> 1.057703, 1.057703, 1.057703, 1.057703, 1.… #> $ psu                         <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, … #> $ doi                         <dbl> 1386, 1386, 1386, 1386, 1386, 1386, 1386, … #> $ sex                         <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f… #> $ sibindex                    <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, … #> $ sib.sex                     <chr> \"m\", \"f\", \"m\", \"f\", \"m\", \"f\", \"m\", \"f\", \"m… #> $ sib.alive                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, … #> $ sib.age                     <dbl> 42, 27, 46, 33, 40, 49, 22, 30, 49, 50, 35… #> $ sib.dob                     <dbl> 876, 1056, 828, 984, 900, 792, 1116, 1020,… #> $ sib.marital.status          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.yrsago            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.age               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.date              <dbl> -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1… #> $ sib.died.pregnant           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.died.bc.pregnancy       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.cause             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.time.delivery.death     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.place.death             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.num.children            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.year              <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ alternum                    <chr> \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", … #> $ sib.endobs                  <dbl> 1386, 1386, 1386, 1386, 1386, 1386, 1386, … #> $ sibid                       <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… #> $ sib.preg_related.death.date <dbl> NA, -1, NA, -1, NA, -1, NA, -1, NA, NA, -1… #> $ sib.maternal.death.date     <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"laying-the-groundwork","dir":"Articles","previous_headings":"Overview","what":"Laying the groundwork","title":"Estimating maternal mortality rates from sibling history data","text":"First, ’ll need add indicator variable sibling’s frame population membership. words, need create variable value 1 sibling eligible respond survey, 0 otherwise. example data, ’ll assume conditions similar typical DHS survey hold: .e., ’ll assume survey design siblings eligible respond alive female ages 15 49 given survey, criteria differ. ’ll find criteria inclusion frame population order produce estimates sibling histories. Let’s look distribution frame population membership example dataset, small number .F values missing. (real dataset, well .) Since need able determine whether sibling frame population, drop siblings missing .F values analysis. Finally, since focus pregnancy-related deaths vignette, drop male sibs. ’ll also keep female sibs age 49.","code":"ex.sib <- ex.sib %>%    mutate(in.F = as.numeric((sib.alive==1) & (sib.age >= 15) & (sib.age <= 49) & (sib.sex == 'f'))) with(ex.sib, table(in.F, useNA='ifany')) #> in.F #>     0     1  <NA>  #> 22826 11513   101 ex.sib <- ex.sib %>% filter(! is.na(in.F)) ex.sib <- ex.sib %>%    filter(sib.sex == 'f')"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"specifying-cells","dir":"Articles","previous_headings":"Overview","what":"Specifying cells","title":"Estimating maternal mortality rates from sibling history data","text":"produce estimated maternal death rates sibling histories, usually different sex X age group X time period combinations. called cells. next step create object describes cells plan produce death rate estimates . means need specify time period age groups ’ll using. ’ll use helper function cell_config : ’re specifying want 5-year age groups, starting 15 ending 65 produce estimates 7-year window survey interview (, slightly different respondent) dob column sibling dataset time siblings start observed (birthdate) endobs column sibling dataset time siblings stop observed (interview , ’re dead, date death) sib.preg_related.death.date column sibling dataset date sibling death considered pregnancy-related (maternal causes, use sib.maternal.death.date, available many DHS surveys) doi column sibling dataset date respondent reported sibling interviewed survey, times counted months, set exp.scale=1/12 indicate need divide total exposures 12 get years","code":"cc_pr <- cell_config(age.groups='5yr',                       time.periods='7yr_beforeinterview',                      start.obs='sib.dob',    # date of birth                      end.obs='sib.endobs',   # either the date respondent was interviewed (if sib is alive) or date of death (if sib is dead)                      event='sib.preg_related.death.date', # date of death (for sibs who died of maternal causes)                      age.offset='sib.dob',   # date of birth                      time.offset='doi',      # date of interview                      event.name='pr_death',  # pregnancy-related death                      exp.scale=1/12)"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"estimating-pregnancy-related-death-rates","dir":"Articles","previous_headings":"Overview","what":"Estimating pregnancy-related death rates","title":"Estimating maternal mortality rates from sibling history data","text":"Given preparatory steps, sibling_estimator function take care estimating pregnancy-related death rates sibling histories us. sibling_estimator returns list results. ’ll focus asdr.ind, individual visibility estimates, asdr.agg, aggregate visibility estimates. individual visibility estimates: aggregate visibility estimates","code":"ex_ests <- sibling_estimator(sib.dat = ex.sib,                              ego.id = 'caseid',            # column with the respondent id                              sib.id = 'sibid',             # column with sibling id                                                             # (unique for each reported sibling)                              sib.frame.indicator = 'in.F', # indicator for sibling frame population membership                              sib.sex = 'sib.sex',          # column with sibling's sex                              cell.config=cc_pr,            # cell configuration we created above                              weights='wwgt')               # column with the respondents' sampling weights  names(ex_ests) #> [1] \"asdr.ind\" \"asdr.agg\" \"ec.dat\"   \"esc.dat\" ex_ests$asdr.ind #> # A tibble: 10 × 11 #>    time.period  sib.sex sib.age num.hat denom.hat ind.y.F     n wgt.sum asdr.hat #>    <chr>        <chr>   <chr>     <dbl>     <dbl>   <dbl> <int>   <dbl>    <dbl> #>  1 7yr_beforei… f       [15,20)  15.5      7724.   11401.  6864   6798. 0.00200  #>  2 7yr_beforei… f       [20,25)   9.46     7932.   11401.  6864   6798. 0.00119  #>  3 7yr_beforei… f       [25,30)   7.17     6980.   11401.  6864   6798. 0.00103  #>  4 7yr_beforei… f       [30,35)  12.9      5549.   11401.  6864   6798. 0.00233  #>  5 7yr_beforei… f       [35,40)   5.94     4336.   11401.  6864   6798. 0.00137  #>  6 7yr_beforei… f       [40,45)   1.63     2746.   11401.  6864   6798. 0.000594 #>  7 7yr_beforei… f       [45,50)   0        1752.   11401.  6864   6798. 0        #>  8 7yr_beforei… f       [50,55)   0.758     987.   11401.  6864   6798. 0.000768 #>  9 7yr_beforei… f       [55,60)   0         422.   11401.  6864   6798. 0        #> 10 7yr_beforei… f       [60,65)   0          88.1  11401.  6864   6798. 0        #> # ℹ 2 more variables: estimator <chr>, event.name <chr> ex_ests$asdr.agg #> # A tibble: 10 × 10 #>    time.period   sib.sex sib.age num.hat denom.hat     n wgt.sum asdr.hat #>    <chr>         <chr>   <chr>     <dbl>     <dbl> <int>   <dbl>    <dbl> #>  1 7yr_beforeint f       [15,20)  29.2      14696.  6864   6798. 0.00199  #>  2 7yr_beforeint f       [20,25)  24.1      15949.  6864   6798. 0.00151  #>  3 7yr_beforeint f       [25,30)  18.2      14467.  6864   6798. 0.00126  #>  4 7yr_beforeint f       [30,35)  22.8      11597.  6864   6798. 0.00197  #>  5 7yr_beforeint f       [35,40)  12.8       8852.  6864   6798. 0.00144  #>  6 7yr_beforeint f       [40,45)   2.61      5321.  6864   6798. 0.000491 #>  7 7yr_beforeint f       [45,50)   0         3066.  6864   6798. 0        #>  8 7yr_beforeint f       [50,55)   0.758     1573.  6864   6798. 0.000482 #>  9 7yr_beforeint f       [55,60)   0          609.  6864   6798. 0        #> 10 7yr_beforeint f       [60,65)   0          111.  6864   6798. 0        #> # ℹ 2 more variables: estimator <chr>, event.name <chr>"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"plotting-the-results","dir":"Articles","previous_headings":"Overview","what":"Plotting the results","title":"Estimating maternal mortality rates from sibling history data","text":"’ll make plots showing results. ’ll show results age 50, typically pregnancy-related mortality analyzed.","code":"ggplot(ex_ests$asdr.ind %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('individual visibility estimator\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. ggplot(ex_ests$asdr.agg %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('aggregate visibility estimator\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. compare <- bind_rows(ex_ests$asdr.ind, ex_ests$asdr.agg)  ggplot(compare %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, linetype=estimator, group=interaction(estimator, sib.sex))) +   theme_minimal() +   #facet_grid(sex ~ .) +   facet_grid(. ~ sib.sex) +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('both estimators\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values."},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"aggregating-estimates-across-ages","dir":"Articles","previous_headings":"","what":"Aggregating estimates across ages","title":"Estimating maternal mortality rates from sibling history data","text":"Problem: ex.sib doesn’t column age.cat","code":"mmrate <- aggregate_maternal_estimates(ex_ests, ex.ego, ex.sib) #> Joining with `by = join_by(.ego.id, .weight, sex)` #> Joining with `by = join_by(time.period, sib.sex, sib.age, event.name)` mmrate #> # A tibble: 1 × 7 #>   ind.est agg.est adj.factor adj.factor.allage adj.factor.meanagespec #>     <dbl>   <dbl>      <dbl>             <dbl>                  <dbl> #> 1 0.00138 0.00143      0.430             0.577                  0.573 #> # ℹ 2 more variables: ratio.agg.ind <dbl>, ratio.ind.agg <dbl>"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/maternal-estimates.html","id":"variance-estimates","dir":"Articles","previous_headings":"","what":"Variance estimates","title":"Estimating maternal mortality rates from sibling history data","text":"practice, want point estimates estimated sampling uncertainty death rates. ’ll use rescaled bootstrap estimate sampling uncertainty. can done surveybootstrap package. use rescaled bootstrap, need know little bit sampling design survey ’re working . example dataset, stratified, multistage design. ’ll need tell bootstrap function strata primary sampling units. example data, indicated ‘stratum’ ‘psu’ columns dataset. (NOTE: takes minute 2018 MBP 1000 resamples.) result, bootweights, dataframe row survey respondent, column survey respondent’s ID, num.boot.reps columns containing survey weights result bootstrap procedure. basic idea calculate estimated death rates using one num.boot.reps sets weights. variation across estimates estimator sampling variation. make easier, sibling_estimator function can take dataset bootstrap resampled weights; calculate summarize estimates . (NOTE: slow; takes 35 minutes 2018 MBP bootweights 1000 resamples.) Finally, let’s plot estimated death rates along sampling uncertainty:    Finally, can calculate aggregated MMRate pregnancy-related mortality using bootstrap resamples.","code":"set.seed(101010)  tic('running bootstrap') ## this will take a little while -- for 1000 reps, it takes about 10 minutes on a 2018 Macbook Pro #num.boot.reps <- 1000 # reduce number of reps to help vignette build faster num.boot.reps <- 100   # The Guide to DHS Statistics DHS-8 # suggests using what we call the `stratum_design` variable # (v023) in calculating sampling-based standard errors bootweights <- surveybootstrap::rescaled.bootstrap.weights(survey.design = ~ psu + strata(stratum_design),                                                            # a high number is good here, though that will obviously                                                            # make everything take longer                                                            num.reps=num.boot.reps,                                                            idvar='caseid',       # column with the respondent ids                                                            weights='wwgt', # column with the sampling weight                                                            survey.data=ex.ego    # note that we pass in the respondent data, NOT the sibling data                                                            ) #> Warning: Unquoting language objects with `!!!` is deprecated as of rlang 0.4.0. Please #> use `!!` instead. #>  #> # Bad: dplyr::select(data, !!!enquo(x)) #>  #> # Good: dplyr::select(data, !!enquo(x)) # Unquote single quosure #> dplyr::select(data, !!!enquos(x)) # Splice list of quosures #> This warning is displayed once every 8 hours. toc() #> running bootstrap: 0.793 sec elapsed # to save time, we'll only use a subset of the bootstrap replicates  short.bootweights <- bootweights %>% select(1:11)  #est.bootweights <- bootweights est.bootweights <- short.bootweights  tic('calculating estimates with bootstrap') ex_boot_ests <- sibling_estimator(sib.dat = ex.sib,                                   ego.id = 'caseid',                                   sib.id = 'sibid',                                   sib.frame.indicator = 'in.F',                                   sib.sex = 'sib.sex',                                   cell.config=cc_pr,                                   boot.weights=est.bootweights,  # to get sampling uncertainty, we pass boot.weights into sibling_estimator                                   return.boot=TRUE,                # when TRUE, return all of the resampled estimates (not just summaries)                                   weights='wwgt') toc() #> calculating estimates with bootstrap: 5.261 sec elapsed ggplot(ex_boot_ests$asdr.ind %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_ribbon(aes(x=sib.age, ymin=1000*asdr.hat.ci.low, ymax=1000*asdr.hat.ci.high, group=sib.sex), alpha=.2) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('individual visibility estimator\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. ggplot(ex_boot_ests$asdr.agg %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_ribbon(aes(x=sib.age, ymin=1000*asdr.hat.ci.low, ymax=1000*asdr.hat.ci.high, group=sib.sex), alpha=.2) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('aggregate visibility estimator\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. compare_boot <- bind_rows(ex_boot_ests$asdr.ind, ex_boot_ests$asdr.agg)  ggplot(compare_boot %>% filter(! sib.age %in% c(\"[50,55)\", \"[55,60)\", \"[60,65)\"))) +   geom_ribbon(aes(x=sib.age, ymin=1000*asdr.hat.ci.low, ymax=1000*asdr.hat.ci.high, fill=estimator, group=estimator), alpha=.2) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=estimator, group=interaction(estimator))) +   theme_minimal() +   scale_y_log10() +    ylab(\"1,000 X PRMR\") +   ggtitle('both estimators\\npregnancy-related mortality, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. #> log-10 transformation introduced infinite values. mmrate_boot <- aggregate_maternal_estimates(ex_boot_ests, ex.ego, ex.sib) #> Joining with `by = join_by(.ego.id, .weight, sex)` #> Joining with `by = join_by(time.period, sib.sex, sib.age, event.name)` #> Joining with `by = join_by(time.period, sib.sex, sib.age, boot_idx, #> event.name)` names(mmrate_boot) #> [1] \"point\"     \"boot_summ\" \"boot\""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/preparing-data.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Preparing DHS data","text":"vignette shows prepare DHS-style dataset analysis siblingsurvival model. First, ’ll open model DHS dataset, available ; see also webpage. ’re going using Individual Recode, , generally, ’s easiest start using Stata-formatted version (neither R version, easy--use plain text format like .csv provided). ’ll assume ’ve read individual recode version dataset R using haven::read_dta, ’re calling model_dhs_dat. Next, ’ll open varmap, maps column names raw DHS data user-friendly names. --date list DHS versions recodes available . Using varmap, get vector names respondent (ego) variables Using varmap, get vector names sibling variables ’ll need prepare two different datasets: first dataset information women responded survey; ’ll call respondent ego dataset. second dataset information reported siblings; ’ll call sibling dataset.","code":"data(model_dhs_dat) data(sibhist_varmap_dhs6) ## ego (respondent) variables to grab tmp <- subset(sibhist_varmap_dhs6, sibvar==0) resp.attrib <- tmp$orig.varname names(resp.attrib) <- tmp$new.varname resp.attrib #>           caseid           survey          cluster            hhnum  #>         \"caseid\"           \"v000\"           \"v001\"           \"v002\"  #>            hrnum             wwgt             year              doi  #>           \"v003\"           \"v005\"           \"v007\"           \"v008\"  #>              age             age5              psu stratum_analysis  #>           \"v012\"           \"v013\"           \"v021\"           \"v022\"  #>   stratum_design           region       ruralurban             educ  #>           \"v023\"           \"v024\"           \"v025\"           \"v106\"  #>            relig        ethnicity           hhsize      educ_recode  #>           \"v130\"           \"v131\"           \"v136\"           \"v149\"  #>         literacy    mm_occurences     mm_preceding  #>           \"v155\"           \"mmc1\"           \"mmc2\" ## alter (sibling) variables to grab tmp <- subset(sibhist_varmap_dhs6, sibvar==1) sib.attrib <- tmp$orig.varname names(sib.attrib) <- tmp$new.varname sib.attrib #>                sibindex                 sib.sex               sib.alive  #>                 \"mmidx\"                   \"mm1\"                   \"mm2\"  #>                 sib.age                 sib.dob      sib.marital.status  #>                   \"mm3\"                   \"mm4\"                   \"mm5\"  #>        sib.death.yrsago           sib.death.age          sib.death.date  #>                   \"mm6\"                   \"mm7\"                   \"mm8\"  #>       sib.died.pregnant   sib.died.bc.pregnancy         sib.death.cause  #>                   \"mm9\"                  \"mm10\"                  \"mm11\"  #> sib.time.delivery.death         sib.place.death        sib.num.children  #>                  \"mm12\"                  \"mm13\"                  \"mm14\"  #>          sib.death.year       sib.died.accident  #>                  \"mm15\"                  \"mm16\""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/preparing-data.html","id":"prepare-the-respondent-ego-dataset","dir":"Articles","previous_headings":"","what":"Prepare the respondent (ego) dataset","title":"Preparing DHS data","text":"","code":"ex.ego <- model_dhs_dat %>%    # use information from the varmap to rename ego variables   rename(!!!resp.attrib) %>%   mutate(     ## typically, only women are asked sibling histories in DHS surveys     sex='f',     ## these breaks should agree with the ones     ## used in the age categories for siblings     ## (see below)     age.cat=fct_drop(cut(age,       breaks=c(0, seq(from=15,to=50,by=5),95),       include.lowest=TRUE, right=FALSE)),     ## we'll rescale the weights, dividing them by 1,000,000      ## (so that their average is 1); see DHS documentation     wwgt=wwgt/1e6   )   ex.ego %>% head() #> # A tibble: 6 × 4,277 #>   caseid    survey cluster hhnum hrnum  v004  wwgt  v006  year   doi  v009  v010 #>   <chr>     <chr>    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> #> 1 \"       … ZZ6          1     1     2     1  1.06     6  2015  1386     6  1985 #> 2 \"       … ZZ6          1     3     2     1  1.06     6  2015  1386     4  1993 #> 3 \"       … ZZ6          1     4     2     1  1.06     6  2015  1386     4  1973 #> 4 \"       … ZZ6          1     4     3     1  1.06     6  2015  1386     7  1989 #> 5 \"       … ZZ6          1     5     1     1  1.06     6  2015  1386     2  1990 #> 6 \"       … ZZ6          1     6     2     1  1.06     6  2015  1386     2  1978 #> # ℹ 4,265 more variables: v011 <dbl>, age <dbl>, age5 <dbl>, v014 <dbl>, #> #   v015 <dbl>, v016 <dbl>, v017 <dbl>, v018 <dbl>, v019 <dbl>, v019a <dbl>, #> #   v020 <dbl>, psu <dbl>, stratum_analysis <dbl>, stratum_design <dbl>, #> #   region <dbl>, ruralurban <dbl>, v026 <dbl>, v027 <dbl>, v028 <dbl>, #> #   v029 <dbl>, v030 <dbl>, v031 <dbl>, v032 <dbl>, v034 <dbl>, v040 <dbl>, #> #   v042 <dbl>, v044 <dbl>, v101 <dbl>, v102 <dbl>, v103 <dbl>, v104 <dbl>, #> #   v105 <dbl>, educ <dbl>, v107 <dbl>, v113 <dbl>, v115 <dbl>, v116 <dbl>, …"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/preparing-data.html","id":"prepare-the-sibling-reports-dataset","dir":"Articles","previous_headings":"","what":"Prepare the sibling reports dataset","title":"Preparing DHS data","text":"Next, ’ll prepare dataset sibling reports. ’ll start using attributes..long convert wide-form sibling data long format analysis: Now ’ll recoding. Turn sib.sex variable readable values: Next, need create new variable, sib.endobs, date (century month code, CMC) stopped observing sibling. Generally, date either time sibling died, date interview. siblings currently alive, ’ll recode date death -1; ensures count exposure, deaths (since alive). ’ll also create unique id reported sibling. Now ’ll quality checks, removing sibling reports enough information make use . First, ’ll figure many siblings unknown survival status, ’ll drop . Next, ’ll figure many siblings unknown sex, ’ll drop , . ’ll keep small subset ego variables, keep things manageable","code":"sibdata <- siblingsurvival::attributes.to.long(ex.ego,                                                attribute.prefix=sib.attrib,                                                ego.vars=c('caseid', 'wwgt',                                                            'psu', 'doi'),                                                idvar=\"caseid\") glimpse(sibdata) #> Rows: 35,082 #> Columns: 22 #> $ .tmpid                  <chr> \"        1  1  2\", \"        1  3  2\", \"       … #> $ caseid                  <chr> \"        1  1  2\", \"        1  3  2\", \"       … #> $ wwgt                    <dbl> 1.057703, 1.057703, 1.057703, 1.057703, 1.0577… #> $ psu                     <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ doi                     <dbl> 1386, 1386, 1386, 1386, 1386, 1386, 1386, 1386… #> $ sibindex                <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ sib.sex                 <dbl> 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1… #> $ sib.alive               <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1… #> $ sib.age                 <dbl> 42, 27, 46, 33, 40, 49, 22, 30, 49, 50, 35, NA… #> $ sib.dob                 <dbl> 876, 1056, 828, 984, 900, 792, 1116, 1020, 792… #> $ sib.marital.status      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.yrsago        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 3,… #> $ sib.death.age           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 42… #> $ sib.death.date          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 13… #> $ sib.died.pregnant       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.died.bc.pregnancy   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.cause         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.time.delivery.death <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.place.death         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.num.children        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.year          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ alternum                <chr> \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", \"01\"… sibdata.coded <- sibdata %>%   mutate(sib.sex = ifelse(sib.sex == 2, 'f', 'm')) ## make the assumption that ##  (1) sibs who died lived all the way through ##      the month in which they are reported to have died ##  (2) the interview took place on the first of the month ## these assumptions are necessary to get these tables to line up ## with the DHS reports sibdata.coded$sib.endobs <- pmin(sibdata.coded$doi,                                  sibdata.coded$sib.death.date + 1,                                  na.rm=TRUE) ## siblings who haven't died get their death dates ## recoded to -1 so we don't lose the exposures they ## contribute... sibdata.coded$sib.death.date[ is.na(sibdata.coded$sib.death.date) ] <- -1 sibdata.coded$sibid <- 1:nrow(sibdata) ## CALCULATE % of siblings with unknown survival status; ## we are taking them out of the analysis here sibdata.coded %>%    group_by(sib.alive) %>%    summarise(freq=n()) %>%    mutate(frac=freq/sum(freq)) #> # A tibble: 4 × 3 #>   sib.alive  freq     frac #>       <dbl> <int>    <dbl> #> 1         0  5314 0.151    #> 2         1 29130 0.830    #> 3         8     9 0.000257 #> 4        NA   629 0.0179  pre.n <- nrow(sibdata.coded) sibdata.coded <- sibdata.coded %>% filter(sib.alive %in% c(0,1)) post.n <- nrow(sibdata.coded)  cat(paste0(\"Removed \", pre.n-post.n, \" out of \", pre.n, \" (\", round(100*(pre.n-post.n)/pre.n,2), \"%)\",            \" reports about sibs with unknown survival status.\\n\")) #> Removed 638 out of 35082 (1.82%) reports about sibs with unknown survival status. ## CALCULATE % of siblings with unknown sex sibdata.coded %>%    group_by(sib.sex) %>%    summarise(freq=n()) %>%    mutate(frac=freq/sum(freq)) #> # A tibble: 3 × 3 #>   sib.sex  freq     frac #>   <chr>   <int>    <dbl> #> 1 f       17221 0.500    #> 2 m       17219 0.500    #> 3 NA          4 0.000116  ## we're removing them from the analysis here pre.n <- nrow(sibdata.coded) sibdata.coded <- sibdata.coded %>% filter(sib.sex %in% c('f', 'm')) post.n <- nrow(sibdata.coded)  cat(paste0(\"Removed \", pre.n-post.n, \" out of \", pre.n, \" (\", round(100*(pre.n-post.n)/pre.n,2), \"%)\",            \" reports about sibs with unknown sex.\\n\")) #> Removed 4 out of 34444 (0.01%) reports about sibs with unknown sex.  ex.sib <- sibdata.coded ex.ego <- ex.ego %>% select(!!!c(names(resp.attrib), 'sex', 'age.cat'))"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/preparing-data.html","id":"done","dir":"Articles","previous_headings":"","what":"Done!","title":"Preparing DHS data","text":"Now two datasets, ex.ego ex.sib prepped ready go!","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/preparing-data.html","id":"using-prep_dhs_sib_histories","dir":"Articles","previous_headings":"","what":"Using prep_dhs_sib_histories","title":"Preparing DHS data","text":"package includes function, prep_dhs_sib_histories, can used load sibling data, following steps just described. works like :","code":"data(model_dhs_dat) data(sibhist_varmap_dhs6)  prepped <- prep_dhs_sib_histories(model_dhs_dat,                                   varmap = sibhist_varmap_dhs6,                                   keep_missing = FALSE) #>  #> No information on respondent sex given; assuming all respondents are female. #>  #> Found wwgt column; assuming we have a DHS survey and scaling weights. #> 638 out of 35082 (1.82%) reports about sibs have unknown survival status. #> 602 out of 35082 (1.72%) reports about sibs have unknown sex. #> Removing reported sibs missing survival status or sex. #> ... this removes  642  out of  35082  ( 1.83 %)  sibling reports.  str(prepped, 1) #> List of 4 #>  $ survey : chr \"ZZ6\" #>  $ ego.dat: tibble [8,348 × 4,278] (S3: tbl_df/tbl/data.frame) #>  $ sib.dat:'data.frame': 34440 obs. of  25 variables: #>  $ summ   : tibble [1 × 11] (S3: tbl_df/tbl/data.frame)"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Estimating death rates from sibling history data","text":"helpful define important terms start analysis: ego - ego survey respondent cell - cell generic group wish produce estimates. Usually, cell defined time period, age range, sex. , example, cell might women age 30-34 2015. purposes vignette, ’ll assume starting two datasets: one dataset row survey respondent one dataset row sibling reported survey respondent ’ll calculate estimates sibling histories three main steps: Create esc dataset, called row ego X sibling X cell Aggregate esc dataset ec dataset, row reports made ego cell Aggregate ec dataset estimates death rates, using either individual aggregate visibility approach ()","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"opening-up-the-demo-datasets","dir":"Articles","previous_headings":"Overview","what":"Opening up the demo datasets","title":"Estimating death rates from sibling history data","text":"’ll start opening demonstration DHS dataset. Now ’ll use prep_dhs_sib_histories ready sibling histories analysis. (Please see Preparing Data vignette details.) Let’s take look datasets ’ve produced. First, ’s dataset information survey respondents. (’ll refer survey respondents ‘ego’): ’s long-form version sibling history data – ’s one row reported sibling.","code":"data(model_dhs_dat) prepped <- prep_dhs_sib_histories(model_dhs_dat,                                   varmap = sibhist_varmap_dhs6,                                   keep_missing = FALSE) #>  #> No information on respondent sex given; assuming all respondents are female. #>  #> Found wwgt column; assuming we have a DHS survey and scaling weights. #> 638 out of 35082 (1.82%) reports about sibs have unknown survival status. #> 602 out of 35082 (1.72%) reports about sibs have unknown sex. #> Removing reported sibs missing survival status or sex. #> ... this removes  642  out of  35082  ( 1.83 %)  sibling reports.  # we'll only keep the variable we will need for this analysis ex.ego <- prepped$ego.dat %>%   ## add a 'sex' variable   mutate(sex = 'f') %>%   select(caseid,           psu,           stratum_analysis,           stratum_design,           cluster,           age.cat, sex, wwgt) ex.sib <- prepped$sib.dat glimpse(ex.ego) #> Rows: 8,348 #> Columns: 8 #> $ caseid           <chr> \"        1  1  2\", \"        1  3  2\", \"        1  4  … #> $ psu              <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,… #> $ stratum_analysis <dbl> 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 2… #> $ stratum_design   <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,… #> $ cluster          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,… #> $ age.cat          <fct> \"[30,35)\", \"[20,25)\", \"[40,45)\", \"[25,30)\", \"[25,30)\"… #> $ sex              <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\"… #> $ wwgt             <dbl> 1.057703, 1.057703, 1.057703, 1.057703, 1.057703, 1.0… glimpse(ex.sib) #> Rows: 34,440 #> Columns: 25 #> $ .tmpid                  <chr> \"        1  1  2\", \"        1  3  2\", \"       … #> $ caseid                  <chr> \"        1  1  2\", \"        1  3  2\", \"       … #> $ wwgt                    <dbl> 1.057703, 1.057703, 1.057703, 1.057703, 1.0577… #> $ psu                     <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ doi                     <dbl> 1386, 1386, 1386, 1386, 1386, 1386, 1386, 1386… #> $ sex                     <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"… #> $ sibindex                <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1… #> $ sib.sex                 <chr> \"m\", \"f\", \"m\", \"f\", \"m\", \"f\", \"m\", \"f\", \"m\", \"… #> $ sib.alive               <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1… #> $ sib.age                 <dbl> 42, 27, 46, 33, 40, 49, 22, 30, 49, 50, 35, NA… #> $ sib.dob                 <dbl> 876, 1056, 828, 984, 900, 792, 1116, 1020, 792… #> $ sib.marital.status      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.yrsago        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 3,… #> $ sib.death.age           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 42… #> $ sib.death.date          <dbl> -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 13… #> $ sib.died.pregnant       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.died.bc.pregnancy   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.cause         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.time.delivery.death <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.place.death         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.num.children        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ sib.death.year          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ alternum                <chr> \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", \"01\", \"01\"… #> $ sib.endobs              <dbl> 1386, 1386, 1386, 1386, 1386, 1386, 1386, 1386… #> $ sibid                   <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,…"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"laying-the-groundwork","dir":"Articles","previous_headings":"Overview","what":"Laying the groundwork","title":"Estimating death rates from sibling history data","text":"First, ’ll need add indicator variable sibling’s frame population membership. words, need create variable value 1 sibling eligible respond survey, 0 otherwise. example data, ’ll assume conditions similar typical DHS survey hold: .e., ’ll assume survey design siblings eligible respond alive female ages 15 50 given survey, criteria differ. ’ll find criteria inclusion frame population order produce estimates sibling histories. Let’s look distribution frame population membership example dataset, small number .F values missing. (real dataset, well .) Since need able determine whether sibling frame population, drop siblings missing .F values analysis.","code":"ex.sib <- ex.sib %>%    mutate(in.F = as.numeric((sib.alive==1) & (sib.age >= 15) & (sib.age <= 49) & (sib.sex == 'f'))) with(ex.sib, table(in.F, useNA='ifany')) #> in.F #>     0     1  <NA>  #> 22826 11513   101 ex.sib <- ex.sib %>% filter(! is.na(in.F))"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"specifying-cells","dir":"Articles","previous_headings":"Overview","what":"Specifying cells","title":"Estimating death rates from sibling history data","text":"produce estimated death rates sibling histories, usually different sex X age group X time period combinations. called cells. next step create object describes cells plan produce death rate estimates . means need specify time period age groups ’ll using. ’ll use helper function cell_config : ’re specifying want 5-year age groups, starting 15 ending 65 produce estimates 7-year window survey interview (, slightly different respondent) dob column sibling dataset time siblings start observed (birthdate) endobs column sibling dataset time siblings stop observed (interview , ’re dead, date death) death.date column sibling dataset date sibling died (sibling died) doi column sibling dataset date respondent reported sibling interviewed survey, times counted months, set exp.scale=1/12 indicate need divide total exposures 12 get years","code":"cc <- cell_config(age.groups='5yr',                    time.periods='7yr_beforeinterview',                   start.obs='sib.dob',    # date of birth                   end.obs='sib.endobs',   # either the date respondent was interviewed (if sib is alive) or date of death (if sib is dead)                   event='sib.death.date', # date of death (for sibs who died)                   age.offset='sib.dob',   # date of birth                   time.offset='doi',      # date of interview                   exp.scale=1/12)"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"estimating-death-rates","dir":"Articles","previous_headings":"Overview","what":"Estimating death rates","title":"Estimating death rates from sibling history data","text":"Given preparatory steps, sibling_estimator function take care estimating death rates sibling histories us. sibling_estimator returns list results. ’ll focus asdr.ind, individual visibility estimates, asdr.agg, aggregate visibility estimates. individual visibility estimates: aggregate visibility estimates","code":"ex_ests <- sibling_estimator(sib.dat = ex.sib,                              ego.id = 'caseid',            # column with the respondent id                              sib.id = 'sibid',             # column with sibling id                                                             # (unique for each reported sibling)                              sib.frame.indicator = 'in.F', # indicator for sibling frame population membership                              sib.sex = 'sib.sex',          # column with sibling's sex                              cell.config=cc,               # cell configuration we created above                              weights='wwgt')               # column with the respondents' sampling weights  names(ex_ests) #> [1] \"asdr.ind\" \"asdr.agg\" \"ec.dat\"   \"esc.dat\" glimpse(ex_ests$asdr.ind) #> Rows: 20 #> Columns: 10 #> $ time.period <chr> \"7yr_beforeint\", \"7yr_beforeint\", \"7yr_beforeint\", \"7yr_be… #> $ sib.sex     <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"m\", \"m\"… #> $ sib.age     <chr> \"[15,20)\", \"[20,25)\", \"[25,30)\", \"[30,35)\", \"[35,40)\", \"[4… #> $ num.hat     <dbl> 40.632794, 58.452102, 37.335533, 35.027380, 27.127385, 19.… #> $ denom.hat   <dbl> 7724.0549, 7931.6173, 6980.3260, 5548.5989, 4336.3677, 274… #> $ ind.y.F     <dbl> 11400.964, 11400.964, 11400.964, 11400.964, 11400.964, 114… #> $ n           <int> 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864… #> $ wgt.sum     <dbl> 6798.047, 6798.047, 6798.047, 6798.047, 6798.047, 6798.047… #> $ asdr.hat    <dbl> 0.005260552, 0.007369506, 0.005348680, 0.006312833, 0.0062… #> $ estimator   <chr> \"sib_ind\", \"sib_ind\", \"sib_ind\", \"sib_ind\", \"sib_ind\", \"si… glimpse(ex_ests$asdr.agg) #> Rows: 20 #> Columns: 9 #> $ time.period <chr> \"7yr_beforeint\", \"7yr_beforeint\", \"7yr_beforeint\", \"7yr_be… #> $ sib.sex     <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"m\", \"m\"… #> $ sib.age     <chr> \"[15,20)\", \"[20,25)\", \"[25,30)\", \"[30,35)\", \"[35,40)\", \"[4… #> $ num.hat     <dbl> 80.640472, 108.425029, 66.546631, 61.344200, 46.548261, 33… #> $ denom.hat   <dbl> 14696.0833, 15949.0545, 14466.8583, 11597.0465, 8851.6251,… #> $ n           <int> 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864, 6864… #> $ wgt.sum     <dbl> 6798.047, 6798.047, 6798.047, 6798.047, 6798.047, 6798.047… #> $ asdr.hat    <dbl> 0.005487208, 0.006798210, 0.004599937, 0.005289640, 0.0052… #> $ estimator   <chr> \"sib_agg\", \"sib_agg\", \"sib_agg\", \"sib_agg\", \"sib_agg\", \"si…"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"plotting-the-results","dir":"Articles","previous_headings":"Overview","what":"Plotting the results","title":"Estimating death rates from sibling history data","text":"’ll make plots showing results","code":"ggplot(ex_ests$asdr.ind) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ggtitle('individual visibility estimator, 7yr before survey') ggplot(ex_ests$asdr.agg) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ggtitle('aggregate visibility estimator, 7yr before survey') compare <- bind_rows(ex_ests$asdr.ind, ex_ests$asdr.agg)  ggplot(compare) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, linetype=estimator, group=interaction(estimator, sib.sex))) +   theme_minimal() +   #facet_grid(sex ~ .) +   facet_grid(. ~ sib.sex) +   scale_y_log10() +    ggtitle('both estimators, 7yr before survey')"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"variance-estimates","dir":"Articles","previous_headings":"","what":"Variance estimates","title":"Estimating death rates from sibling history data","text":"practice, want point estimates estimated sampling uncertainty death rates. ’ll use rescaled bootstrap estimate sampling uncertainty. can done surveybootstrap package. use rescaled bootstrap, need know little bit sampling design survey ’re working . example dataset, stratified, multistage design. ’ll need tell bootstrap function strata primary sampling units. example data, indicated ‘stratum’ ‘psu’ columns dataset. (NOTE: takes minute 2018 MBP 1000 resamples.) result, bootweights, dataframe row survey respondent, column survey respondent’s ID, num.boot.reps columns containing survey weights result bootstrap procedure. basic idea calculate estimated death rates using one num.boot.reps sets weights. variation across estimates estimator sampling variation. make easier, sibling_estimator function can take dataset bootstrap resampled weights; calculate summarize estimates . (NOTE: slow; takes 35 minutes 2018 MBP bootweights 1000 resamples.) Finally, let’s plot estimated death rates along sampling uncertainty:","code":"set.seed(101010)  tic('running bootstrap') ## this will take a little while -- for 1000 reps, it takes about 10 minutes on a 2018 Macbook Pro #num.boot.reps <- 1000 # reduce number of reps to help vignette build faster num.boot.reps <- 100   # The Guide to DHS Statistics DHS-8 # suggests using what we call the `stratum_design` variable # (v023) in calculating sampling-based standard errors bootweights <- surveybootstrap::rescaled.bootstrap.weights(survey.design = ~ psu + strata(stratum_design),                                                            # a high number is good here, though that will obviously                                                            # make everything take longer                                                            num.reps=num.boot.reps,                                                            idvar='caseid',       # column with the respondent ids                                                            weights='wwgt', # column with the sampling weight                                                            survey.data=ex.ego    # note that we pass in the respondent data, NOT the sibling data                                                            ) #> Warning: Unquoting language objects with `!!!` is deprecated as of rlang 0.4.0. Please #> use `!!` instead. #>  #> # Bad: dplyr::select(data, !!!enquo(x)) #>  #> # Good: dplyr::select(data, !!enquo(x)) # Unquote single quosure #> dplyr::select(data, !!!enquos(x)) # Splice list of quosures #> This warning is displayed once every 8 hours. toc() #> running bootstrap: 0.711 sec elapsed # to save time, we'll only use a subset of the bootstrap replicates  short.bootweights <- bootweights %>% select(1:11)  #est.bootweights <- bootweights est.bootweights <- short.bootweights  tic('calculating estimates with bootstrap') ex_boot_ests <- sibling_estimator(sib.dat = ex.sib,                                   ego.id = 'caseid',                                   sib.id = 'sibid',                                   sib.frame.indicator = 'in.F',                                   sib.sex = 'sib.sex',                                   cell.config=cc,                                   boot.weights=est.bootweights,  # to get sampling uncertainty, we pass boot.weights into sibling_estimator                                   return.boot=TRUE,                # when TRUE, return all of the resampled estimates (not just summaries)                                   weights='wwgt') toc() #> calculating estimates with bootstrap: 9.197 sec elapsed ggplot(ex_boot_ests$asdr.ind) +   geom_ribbon(aes(x=sib.age, ymin=1000*asdr.hat.ci.low, ymax=1000*asdr.hat.ci.high, fill=sib.sex, group=sib.sex), alpha=.2) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ggtitle('individual visibility estimator, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. ggplot(ex_boot_ests$asdr.agg) +   geom_ribbon(aes(x=sib.age, ymin=1000*asdr.hat.ci.low, ymax=1000*asdr.hat.ci.high, fill=sib.sex, group=sib.sex), alpha=.2) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, group=sib.sex)) +   theme_minimal() +   scale_y_log10() +    ggtitle('aggregate visibility estimator, 7yr before survey') #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values."},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"internal-consistency-checks","dir":"Articles","previous_headings":"","what":"Internal consistency checks","title":"Estimating death rates from sibling history data","text":"section, illustrate conduct internal consistency checks: NOTE: IC checks can take – 36 minutes 1000 bootstrap reps 2018 MBP can look ic.checks$ic.summ, summarized output: ’s often helpful plot results internal consistency checks:","code":"# toggle between short bootweights (faster, for coding) and long bootweights (for realism) ic.bootweights <- short.bootweights #ic.bootweights <- bootweights  tic(\"Internal consistency checks\") ic.checks <- sib_ic_checks(ex_boot_ests$esc.dat,                            ego.dat=ex.ego,                            ego.id='caseid',                            sib.id='sibid',                            sib.frame.indicator='in.F',                            sib.cell.vars=c('sib.age', 'sib.sex'),                            ego.cell.vars=c('age.cat', 'sex'),                            boot.weights=ic.bootweights) toc() #> Internal consistency checks: 0.677 sec elapsed  names(ic.checks) #> [1] \"ic.summ\"      \"ic.boot.ests\" glimpse(ic.checks$ic.summ) #> Rows: 7 #> Columns: 27 #> $ cell                        <chr> \"[15,20)_X_f\", \"[20,25)_X_f\", \"[25,30)_X_f… #> $ age.cat                     <chr> \"[15,20)\", \"[20,25)\", \"[25,30)\", \"[30,35)\"… #> $ sex                         <chr> \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\" #> $ diff_mean                   <dbl> 217.681488, -280.571617, 4.100908, -118.68… #> $ diff_se                     <dbl> 79.80164, 103.48449, 92.09746, 90.32214, 1… #> $ diff_ci_low                 <dbl> 61.31572, -439.30176, -116.38523, -260.483… #> $ diff_ci_high                <dbl> 293.215050, -107.512966, 137.894372, 8.833… #> $ abs_diff_mean               <dbl> 217.68149, 280.57162, 77.89882, 122.88106,… #> $ abs_diff_se                 <dbl> 79.80164, 103.48449, 41.93034, 83.85326, 1… #> $ abs_diff_ci_low             <dbl> 61.31572, 107.51297, 14.76047, 23.69984, 6… #> $ abs_diff_ci_high            <dbl> 293.2151, 439.3018, 144.3283, 260.4840, 54… #> $ diff2_mean                  <dbl> 53116.701, 88358.567, 7650.565, 21427.988,… #> $ diff2_se                    <dbl> 28519.506, 57939.806, 6922.625, 24670.378,… #> $ diff2_ci_low                <dbl> 5646.2832, 13768.2134, 289.0865, 586.9915,… #> $ diff2_ci_high               <dbl> 85983.26, 195463.36, 20965.82, 68297.22, 2… #> $ normalized_diff_mean        <dbl> 1.125949e-05, -1.545307e-05, 2.160616e-07,… #> $ normalized_diff_se          <dbl> 4.372164e-06, 6.935741e-06, 4.343266e-06, … #> $ normalized_diff_ci_low      <dbl> 3.005497e-06, -2.687438e-05, -5.311261e-06… #> $ normalized_diff_ci_high     <dbl> 1.577190e-05, -5.253123e-06, 6.412978e-06,… #> $ abs_normalized_diff_mean    <dbl> 1.125949e-05, 1.545307e-05, 3.693324e-06, … #> $ abs_normalized_diff_se      <dbl> 4.372164e-06, 6.935741e-06, 1.938959e-06, … #> $ abs_normalized_diff_ci_low  <dbl> 3.005497e-06, 5.253123e-06, 6.635886e-07, … #> $ abs_normalized_diff_ci_high <dbl> 1.577190e-05, 2.687438e-05, 6.551828e-06, … #> $ normalized_diff2_mean       <dbl> 1.439804e-10, 2.820916e-10, 1.702425e-11, … #> $ normalized_diff2_se         <dbl> 8.313410e-11, 2.319066e-10, 1.440957e-11, … #> $ normalized_diff2_ci_low     <dbl> 1.420808e-11, 3.354854e-11, 6.805513e-13, … #> $ normalized_diff2_ci_high    <dbl> 2.488334e-10, 7.340667e-10, 4.324025e-11, … ggplot(ic.checks$ic.summ) +   geom_hline(yintercept=0) +   geom_pointrange(aes(x=age.cat,                       y=diff_mean,                       ymin=diff_ci_low,                       ymax=diff_ci_high)) +   theme_minimal() +   ggtitle(\"Internal consistency checks\") +   xlab(\"Age group\") +   ylab(expression(Delta[alpha])) #ggplot(ic.checks$ic.summ) + #  geom_hline(yintercept=0) + #  geom_pointrange(aes(x=age.cat, #                      y=agg_diff_mean, #                      ymin=agg_diff_ci_low, #                      ymax=agg_diff_ci_high)) + #  theme_minimal() + #  ggtitle(\"Internal consistency checks (aggregate)\") + #  xlab(\"Age group\") + #  ylab(expression(Delta[alpha])) # #ggplot(ic.checks$ic.summ) + #  geom_hline(yintercept=0) + #  geom_pointrange(aes(x=age.cat, #                      y=ind_diff_mean, #                      ymin=ind_diff_ci_low, #                      ymax=ind_diff_ci_high)) + #  theme_minimal() + #  ggtitle(\"Internal consistency checks (individual)\") + #  xlab(\"Age group\") + #  ylab(expression(Delta[alpha]))"},{"path":"http://dennisfeehan.org/siblingsurvival/articles/sibling-estimates.html","id":"visibilities","dir":"Articles","previous_headings":"","what":"Visibilities","title":"Estimating death rates from sibling history data","text":"Make adjusted individual estimates plot comparison","code":"sib.F.dat <- ex.sib %>%   group_by(caseid) %>%   summarize(y.F = sum(in.F))  ego.vis <- ex.ego %>%    select(caseid, wwgt, age.cat, sex) %>%   left_join(sib.F.dat, by='caseid')  # if nothing was joined in, there are no sibs ego.vis <- ego.vis %>%   mutate(y.F=ifelse(is.na(y.F), 0, y.F))  ego.vis.agg <- ego.vis %>%   group_by(sex, age.cat) %>%   summarise(y.F.bar = weighted.mean(y.F, wwgt)) %>%   mutate(adj.factor = y.F.bar / (y.F.bar + 1)) #> `summarise()` has regrouped the output. #> ℹ Summaries were computed grouped by sex and age.cat. #> ℹ Output is grouped by sex. #> ℹ Use `summarise(.groups = \"drop_last\")` to silence this message. #> ℹ Use `summarise(.by = c(sex, age.cat))` for per-operation grouping #>   (`?dplyr::dplyr_by`) instead. adj.agg.ests <- ex_ests$asdr.agg %>%   left_join(ego.vis.agg,             by=c('sib.sex'='sex', 'sib.age'='age.cat')) %>%   mutate(adj.factor = ifelse(is.na(adj.factor), 1, adj.factor),          estimator = 'sib_agg_adj',          asdr.hat = asdr.hat * adj.factor) compare <- bind_rows(ex_ests$asdr.ind, ex_ests$asdr.agg, adj.agg.ests)  ggplot(compare) +   geom_line(aes(x=sib.age, y=1000*asdr.hat, color=sib.sex, linetype=estimator, group=interaction(estimator, sib.sex))) +   theme_minimal() +   #facet_grid(sex ~ .) +   facet_grid(. ~ sib.sex) +   scale_y_log10() +    ggtitle('sibling estimators, 7yr before survey')"},{"path":"http://dennisfeehan.org/siblingsurvival/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Dennis M. Feehan. Maintainer.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Feehan DM (2026). siblingsurvival: Tools producing sibling survival estimates. R package version 0.3.0, http://dennisfeehan.org/siblingsurvival/.","code":"@Manual{,   title = {siblingsurvival: Tools for producing sibling survival estimates},   author = {Dennis M. Feehan},   year = {2026},   note = {R package version 0.3.0},   url = {http://dennisfeehan.org/siblingsurvival/}, }"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_esc_ind_vis.html","id":null,"dir":"Reference","previous_headings":"","what":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","title":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","text":"Takes dataframe row respondent X sib X cell adds individual visibility ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_esc_ind_vis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","text":"","code":"add_esc_ind_vis(   esc.dat,   ego.id,   sib.dat,   sib.frame.indicator,   varname = \"ind_vis\" )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_esc_ind_vis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","text":"esc.dat Dataset row respondent X sibling X cell, likely produced get_esc_reports ego.id String name column esc.dat containing survey respondent's id sib.dat Dataset row reported sibling, likely produced TODO sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population varname String name new column added sib.dat containing individual visibility","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_esc_ind_vis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","text":"ESC dataframe additional columns information sibship size visibility: ind_vis_weight - individual visibility weight y.F - number reported sibs frame popn (including respondent) sibship.size - total size reported sibship (including respondent)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_esc_ind_vis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"add individual visibility based on sib reprots to ego X sib X cell reports — add_esc_ind_vis","text":"","code":"# TODO - add example"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"take prepared DHS sibling dataset add maternal death info","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"","code":"add_maternal_deaths(sib_df, keep_missing = FALSE, verbose = TRUE)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"sib_df prepped DHS dataset (probably prep_dhs_sib_histories) keep_missing keep reported sibs missing sex survival status? verbose report detailed summaries?","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"dataframe columns sib.preg_related.death.date sib.maternal.death.date added","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"function checks see column called sib.died.accident. , possible estimate whether death maternal; resulting death dates column sib.maternal.death.date. siblings, sure include sib.death.date (date sibling's death) sib.alive (whether sib alive) sib.sex (sex sibling). Returns dataframe TODO","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/add_maternal_deaths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"take a prepared DHS sibling dataset and add maternal death info — add_maternal_deaths","text":"","code":"# TODO - write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/agenames.html","id":null,"dir":"Reference","previous_headings":"","what":"make labels for age groups — agenames","title":"make labels for age groups — agenames","text":"helper function; see make.even.age.groups ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/agenames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make labels for age groups — agenames","text":"","code":"agenames(aw, min.age, max.age)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/agenames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make labels for age groups — agenames","text":"aw width group min.age first age max.age highest age","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/agenames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make labels for age groups — agenames","text":"see make.age.groups","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/aggregate_maternal_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate total rate based on point estimates — aggregate_maternal_estimates","title":"calculate total rate based on point estimates — aggregate_maternal_estimates","text":"calculate total rate based point estimates","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/aggregate_maternal_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate total rate based on point estimates — aggregate_maternal_estimates","text":"","code":"aggregate_maternal_estimates(estimates, ego.dat, sib.dat, only_females = TRUE)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/aggregate_maternal_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate total rate based on point estimates — aggregate_maternal_estimates","text":"estimates output sibling_estimator ego.dat prepped ego data sib.dat prepped sibling data only_females keep female estimates? Defaults TRUE; see Details, ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/aggregate_maternal_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate total rate based on point estimates — aggregate_maternal_estimates","text":"either tibble estimates aggregated across age groups , bootstrap results, list three entries: point - point estimates (running w/bootstraps) boot_summ - estimates w/ confidence intervals calculated bootstrap reps boot - results bootstrap rep","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/aggregate_maternal_estimates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"calculate total rate based on point estimates — aggregate_maternal_estimates","text":"function aggregates age-specific maternal mortality quantities like maternal death rate pregnancy-related death rate. uses age distribution survey respondents reference population. Note , default, consider estimates females aged 15-49, makes sense aggregating maternal estimates. might occasionally useful run function -cause mortality; case, setting parameter only_female=FALSE include male estimates, (still restrict ages 15-49)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":null,"dir":"Reference","previous_headings":"","what":"attributes.to.long — attributes.to.long","title":"attributes.to.long — attributes.to.long","text":"Start wide-form dataframe reported alters using network method questions convert long-form dataset. example, network survey -migrants, might variables sex age emigre reported connected respondent. study encountered maximum 3 reported emigres across respondents, wide-form dataframe might look like: attributes..long function convert long-form dataframe looks like : (Note make guarantees order reshaped data returned.)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"attributes.to.long — attributes.to.long","text":"","code":"attributes.to.long(   df,   attribute.prefix,   ego.vars = NULL,   keep.na = FALSE,   idvar = NULL,   sep = \"\\\\.|_\",   varname.first = TRUE )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"attributes.to.long — attributes.to.long","text":"df wide-form dataset convert attribute.prefix vector whose entries prefixes names variables dataframe data pertain alter. like re-named long form data, variable names like use long form names entry vector. example , use attribute.prefix=c(\"age\"=\"emage\",                         \"sex\"=\"emsex\"). see regexp, , understand prefixes used match columns dataset; default, assume variables match <either '.' '_'>. ego.vars NULL, names columns dataset refer egos converted long-form. can specify renamed way attribute.prefix. example , use ego.vars=c(\"degree\"=\"resp.d.hat\"). keep.na FALSE, remove columns resulting dataset NAs idvar index name variable data respondent id. NULL, new ids correspond rows data created. sep regular expression wide-form variable names split around. (eg, \"var_01\", sep=\"_\"; \"var.01\" \"\\.\") varname.first TRUE text separator variable name (eg var_01), FALSE otherwise","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"attributes.to.long — attributes.to.long","text":"long-form dataframe attributes reported alters. dataframe include alter.id variable formed using .","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":"todo","dir":"Reference","previous_headings":"","what":"TODO","title":"attributes.to.long — attributes.to.long","text":"follow se / nse pattern , eg, kp functions; interim workaround – eg .data.frame(df)[,idvar] – now now, converts factors characters. obviously ideal. eventually, data type preserved... handle case \"\" effectively. Right now, assume structural missings (eg, report one alter, though three columns ) NA look code middle function commented sure know order rows , can cbind together.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/attributes.to.long.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"attributes.to.long — attributes.to.long","text":"","code":"if (FALSE) { # \\dontrun{    ## TODO add example } # }"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/calculate_sib_ind_visibility.html","id":null,"dir":"Reference","previous_headings":"","what":"given a sib dataset, calculate individual visibility weight for each sib — calculate_sib_ind_visibility","title":"given a sib dataset, calculate individual visibility weight for each sib — calculate_sib_ind_visibility","text":"given sib dataset, calculate individual visibility weight sib","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/calculate_sib_ind_visibility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"given a sib dataset, calculate individual visibility weight for each sib — calculate_sib_ind_visibility","text":"","code":"calculate_sib_ind_visibility(   df,   sib.frame.indicator = \".sib.in.F\",   num.sibs.on.frame.var = \"y.F\",   varname = \"ind_vis\" )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/calculate_sib_ind_visibility.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"given a sib dataset, calculate individual visibility weight for each sib — calculate_sib_ind_visibility","text":"df Dataset sibling reports (possibly cell) sib.frame.indicator String name column df containing 0/1 coded variable indicating whether sib frame population num.sibs..frame.var String name column df containing number sibs frame ego varname String name new column create individual visibility sib","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/calculate_sib_ind_visibility.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"given a sib dataset, calculate individual visibility weight for each sib — calculate_sib_ind_visibility","text":"df new column individual visibility sibling","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cell_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify the cells (age groups, time period) to produce estimates for — cell_config","title":"Specify the cells (age groups, time period) to produce estimates for — cell_config","text":"Specify cells (age groups, time period) produce estimates ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cell_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify the cells (age groups, time period) to produce estimates for — cell_config","text":"","code":"cell_config(   age.groups,   time.periods,   start.obs,   end.obs,   event,   age.offset,   time.offset,   covars = NULL,   event.name = NULL,   exp.scale = 1/12 )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cell_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify the cells (age groups, time period) to produce estimates for — cell_config","text":"age.groups see Details time.periods see Details start.obs column name time observation started end.obs column name time observation ended event column name time event (e.g. date death) age.offset column name sibling's offset age (typically date birth) time.offset column name sibling's offset time (often date survey interview) covars (optional) vector names columns covariates event.name (optional) name event (useful maternal mortality) exp.scale defaults 1/12; see Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cell_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify the cells (age groups, time period) to produce estimates for — cell_config","text":"cell_config object can passed estimation functions describe cells estimates produced .","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cell_config.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify the cells (age groups, time period) to produce estimates for — cell_config","text":"Note parameters require column names expecting strings. column names refer dataset one row reported sibling. passed function, function check column names valid. age.groups can either output one helper functions creating age groups (make.age.groups make.even.age.groups), can '1yr', '5yr', '10yr' standard 1, 5, 10-year age groups ranging 15 65, '1yr_to50', '5yr_to50' standard 1 5-year age groups ranging 15 49 time.periods can either output make.time.periods, can '12mo_beforeinterview', '5yr_beforeinterview', '7yr_beforeinterview' time periods one, five, seven years interview date exp.scale factor used convert differences dates years; usually 1/12, since DHS reports times month (eg Dec 2010 Sept 1995). Differences dates thus denominated months, need multiplied 1/12 convert years.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"cpp_compute_occ_exp — cpp_compute_occ_exp","title":"cpp_compute_occ_exp — cpp_compute_occ_exp","text":"compute occurrences exposures lifelines, age groups, time intervals","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cpp_compute_occ_exp — cpp_compute_occ_exp","text":"","code":"cpp_compute_occ_exp(lambda, alpha, alpha_offset, tau)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cpp_compute_occ_exp — cpp_compute_occ_exp","text":"lambda matrix lifelines whose rows units observation (individuals), whose columns (order): start time, end time, event time alpha matrix whose rows age groups whose columns (order): start time, end time (starting 0) alpha_offset vector birthdate unit observation , generally, offset use age groups alpha tau matrix time periods whose rows units observation (individuals), whose columns (order): start time, end time","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cpp_compute_occ_exp — cpp_compute_occ_exp","text":"list containing two matrices, 'occ' 'exp. matrix one row unit observation (individua) whose columns (exp, order): age group 1 exposure, ..., last age group exposure; (occ, order) age group 1 number events, ..., last age group number events","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cpp_compute_occ_exp — cpp_compute_occ_exp","text":"TODO - write detailed description","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp2.html","id":null,"dir":"Reference","previous_headings":"","what":"cpp_compute_occ_exp — cpp_compute_occ_exp2","title":"cpp_compute_occ_exp — cpp_compute_occ_exp2","text":"compute occurrences exposures lifelines, age groups, time intervals","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cpp_compute_occ_exp — cpp_compute_occ_exp2","text":"","code":"cpp_compute_occ_exp2(lambda, alpha, alpha_offset, tau, thresh = NA_real_)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cpp_compute_occ_exp — cpp_compute_occ_exp2","text":"lambda matrix lifelines whose rows units observation (individuals), whose columns (order): start time, end time, event time alpha matrix whose rows age groups whose columns (order): start time, end time (starting 0) alpha_offset vector birthdate unit observation , generally, offset use age groups alpha tau matrix time periods whose rows units observation (individuals), whose columns (order): start time, end time thresh threshold discretizing exposure: amount exposure meets exceeds threshold, resulting exp set 1; amount exposure less threshold, resulting exp set 0","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cpp_compute_occ_exp — cpp_compute_occ_exp2","text":"list containing two matrices, 'occ' 'exp. matrix one row unit observation (individua) whose columns (exp, order): age group 1 exposure, ..., last age group exposure; (occ, order) age group 1 number events, ..., last age group number events","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/cpp_compute_occ_exp2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cpp_compute_occ_exp — cpp_compute_occ_exp2","text":"TODO - write detailed description","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/ex.ego.html","id":null,"dir":"Reference","previous_headings":"","what":"Example ego-level dataset — ex.ego","title":"Example ego-level dataset — ex.ego","text":"dataset one row per survey respondent (ego), use examples tests.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/ex.ego.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example ego-level dataset — ex.ego","text":"data frame respondent-level variables.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/ex.sib.html","id":null,"dir":"Reference","previous_headings":"","what":"Example sibling-level dataset — ex.sib","title":"Example sibling-level dataset — ex.sib","text":"dataset one row per reported sibling, use examples tests.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/ex.sib.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example sibling-level dataset — ex.sib","text":"data frame sibling-level variables.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_agg_est_from_ec.html","id":null,"dir":"Reference","previous_headings":"","what":"helper function for calculating aggregate visibility estimate from ego X cell data — get_agg_est_from_ec","title":"helper function for calculating aggregate visibility estimate from ego X cell data — get_agg_est_from_ec","text":"helper function calculating aggregate visibility estimate ego X cell data","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_agg_est_from_ec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper function for calculating aggregate visibility estimate from ego X cell data — get_agg_est_from_ec","text":"","code":"get_agg_est_from_ec(ec_dat, wgt_var, cell_vars)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_agg_est_from_ec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper function for calculating aggregate visibility estimate from ego X cell data — get_agg_est_from_ec","text":"ec_dat ego X cell data wgt_var either string name column sampling weights vector names columns bootstrap weights cell_vars vector strings names variables group (cells)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_agg_est_from_ec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"helper function for calculating aggregate visibility estimate from ego X cell data — get_agg_est_from_ec","text":"tibble individual visibility ASDR estimates (including respondents' exposures)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_boot_ests_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast bootstrap estimation using matrix multiplication — get_boot_ests_matrix","title":"Fast bootstrap estimation using matrix multiplication — get_boot_ests_matrix","text":"Replaces wide-dataframe summarize_at + gather/spread approach direct matrix multiplication. cell, computes weighted sums across M bootstrap replicates simultaneously using BLAS routines, avoiding creation 10k-column intermediate dataframes.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_boot_ests_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast bootstrap estimation using matrix multiplication — get_boot_ests_matrix","text":"","code":"get_boot_ests_matrix(   ec_dat,   boot_weights_df,   ego_id_col,   cell_vars,   estimator_type )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_boot_ests_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast bootstrap estimation using matrix multiplication — get_boot_ests_matrix","text":"ec_dat ego X cell data get_ec_reports() boot_weights_df dataframe .ego.id column boot_weight_1..M columns ego_id_col name ego id column ec_dat boot_weights_df cell_vars vector column names defining cells (age, sex, time period, etc) estimator_type either 'ind' (individual visibility) 'agg' (aggregate visibility)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_boot_ests_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast bootstrap estimation using matrix multiplication — get_boot_ests_matrix","text":"long-form data frame one row per cell per bootstrap replicate","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ec_reports.html","id":null,"dir":"Reference","previous_headings":"","what":"get ego X cell reports — get_ec_reports","title":"get ego X cell reports — get_ec_reports","text":"Produces dataframe row respondent X cell containing respondent's reported deaths exposure among siblings cell.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ec_reports.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get ego X cell reports — get_ec_reports","text":"","code":"get_ec_reports(   esc.dat,   ego.id,   sib.dat,   sib.frame.indicator,   cell.vars,   weights,   ind.vis.var = NULL,   discretize.exp = FALSE )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ec_reports.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get ego X cell reports — get_ec_reports","text":"esc.dat Dataset row respondent X sibling X cell, likely produced get_esc_reports ego.id String name column esc.dat containing survey respondent's id sib.dat Dataset row reported sibling, likely produced TODO sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population cell.vars vector Strings containing names columns esc.dat identifying cells group reports (typically age group, sex, time period) weights String name column esc.dat survey weights ind.vis.var String name column esc.dat individual visibility sibling; defaults NULL. NULL, individual visibilities calculated discretize.exp Boolean whether expsoure discretized. yet implemented.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ec_reports.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get ego X cell reports — get_ec_reports","text":"dataframe row respondent X cell containing respondent's reported deaths exposure among siblings cell.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ec_reports.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get ego X cell reports — get_ec_reports","text":"","code":"# TODO - add example"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_age_distn.html","id":null,"dir":"Reference","previous_headings":"","what":"get_ego_age_distribution — get_ego_age_distn","title":"get_ego_age_distribution — get_ego_age_distn","text":"get_ego_age_distribution","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_age_distn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_ego_age_distribution — get_ego_age_distn","text":"","code":"get_ego_age_distn(ego.dat, only_females = TRUE)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_age_distn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_ego_age_distribution — get_ego_age_distn","text":"ego.dat ego dataset (probably prep_dhs_sib_histories) only_females females used calculate age distribution? (default: True)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_age_distn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_ego_age_distribution — get_ego_age_distn","text":"dataframe distribution respondent ages 5-year category, typically used calculating maternal pregnancy-related mortality","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_age_distn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get_ego_age_distribution — get_ego_age_distn","text":"ego_dat assumed two columns: wwgt age.cat","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_df.html","id":null,"dir":"Reference","previous_headings":"","what":"helper to prep the ego dataset — get_ego_df","title":"helper to prep the ego dataset — get_ego_df","text":"helper prep ego dataset","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper to prep the ego dataset — get_ego_df","text":"","code":"get_ego_df(df, resp.attrib, verbose = FALSE)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper to prep the ego dataset — get_ego_df","text":"df survey dataset resp.attrib vector respondent attribute columns (see prep_dhs_sib_histories) verbose see prep_dhs_sib_histories","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ego_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"helper to prep the ego dataset — get_ego_df","text":"prepped ego dataset, used prep_dhs_sib_histories","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_esc_reports.html","id":null,"dir":"Reference","previous_headings":"","what":"Get ego X sibling X cell reports — get_esc_reports","title":"Get ego X sibling X cell reports — get_esc_reports","text":"Produces long-form dataset row respondent-sibling X cell combination","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_esc_reports.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get ego X sibling X cell reports — get_esc_reports","text":"","code":"get_esc_reports(sib.dat, sib.id, ego.id, cell.config)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_esc_reports.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get ego X sibling X cell reports — get_esc_reports","text":"sib.dat long-form sibling history dataset (likely produced TODO) sib.id String name column sib.dat sibling ID ego.id String name column sib.dat ID survey respondent cell.config object containing configuration cells; see TODO information","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_esc_reports.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get ego X sibling X cell reports — get_esc_reports","text":"tbl row respondent-sibling X cell","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_esc_reports.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get ego X sibling X cell reports — get_esc_reports","text":"","code":"# TODO"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":null,"dir":"Reference","previous_headings":"","what":"get a dataset with reports used for internal-consistency checks — get_ic_reports","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"get dataset reports used internal-consistency checks","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"","code":"get_ic_reports(   esc.dat,   ego.dat,   ego.id,   sib.id,   sib.frame.indicator,   sib.cell.vars,   ego.cell.vars )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"esc.dat ego X sibling X cell dataset (see get_esc_reports) ego.dat ego dataset, containing one row survey respondent ego.id String name column esc.dat containing survey respondent ID sib.id String name column esc.dat containing unique sibling ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population sib.cell.vars see Details ego.cell.vars see Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"tibble row reported sibling frame population, sibling's cell info, cell info survey respondent reported sibling, unified variables ego sibs' cell values; unified variables called .ego.cell .sib.cell, used sib_ic_checks.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"sib.cell.vars ego.cell.vars arguments vector Strings containing names columns esc.dat identifying cells group reports (typically age sex, possibly variables). Note , unlike cell.vars argument get_ec_reports, function sib.cell.vars ego.cell.vars MUST age variable listed FIRST. goal get_ic_reports find cell sibling time interview, meaning oldest age group sibling contributed exposure.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ic_reports.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get a dataset with reports used for internal-consistency checks — get_ic_reports","text":"","code":"# TODO write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ind_est_from_ec.html","id":null,"dir":"Reference","previous_headings":"","what":"helper function for calculating individual visibility estimate from ego X cell data — get_ind_est_from_ec","title":"helper function for calculating individual visibility estimate from ego X cell data — get_ind_est_from_ec","text":"helper function calculating individual visibility estimate ego X cell data","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ind_est_from_ec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper function for calculating individual visibility estimate from ego X cell data — get_ind_est_from_ec","text":"","code":"get_ind_est_from_ec(ec_dat, wgt_var, cell_vars)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ind_est_from_ec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper function for calculating individual visibility estimate from ego X cell data — get_ind_est_from_ec","text":"ec_dat ego X cell data wgt_var either string name column sampling weights vector names columns bootstrap weights cell_vars vector strings names variables group (cells)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_ind_est_from_ec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"helper function for calculating individual visibility estimate from ego X cell data — get_ind_est_from_ec","text":"tibble individual visibility ASDR estimates (including respondents' exposures)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sib_df.html","id":null,"dir":"Reference","previous_headings":"","what":"helper to prep the sib dataset — get_sib_df","title":"helper to prep the sib dataset — get_sib_df","text":"helper prep sib dataset","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sib_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper to prep the sib dataset — get_sib_df","text":"","code":"get_sib_df(ego.dat, sib.attrib, verbose = FALSE)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sib_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper to prep the sib dataset — get_sib_df","text":"ego.dat prepped ego dataset sib.attrib vector sibling attribute columns (see prep_dhs_sib_histories) verbose see prep_dhs_sib_histories","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sib_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"helper to prep the sib dataset — get_sib_df","text":"prepped sibling dataset, used prep_dhs_sib_histories","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sibship_info.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate number of sibs on frame for each respondent — get_sibship_info","title":"calculate number of sibs on frame for each respondent — get_sibship_info","text":"quantity, y.F, related visibility respondent","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sibship_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate number of sibs on frame for each respondent — get_sibship_info","text":"","code":"get_sibship_info(sib.dat, ego.id, sib.frame.indicator)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sibship_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate number of sibs on frame for each respondent — get_sibship_info","text":"sib.dat long-form sibling dataset (likely produced prep_dhs_sib_histories) ego.id String name column sib.dat containing survey respondent ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sibship_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate number of sibs on frame for each respondent — get_sibship_info","text":"tibble row survey respondent (unique value ego.id), number sibs respondent reported frame, including including ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_sibship_info.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate number of sibs on frame for each respondent — get_sibship_info","text":"","code":"# TODO write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_visibility.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate visibility for each sibship and ego — get_visibility","title":"calculate visibility for each sibship and ego — get_visibility","text":"calculate visibility sibship ego","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_visibility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate visibility for each sibship and ego — get_visibility","text":"","code":"get_visibility(   ego.dat,   ego.id,   sib.dat,   sib.frame.indicator,   weight = \"wwgt\",   age = \"age.cat\" )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_visibility.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate visibility for each sibship and ego — get_visibility","text":"ego.dat ego dataset (likely produced prep_dhs_sib_histories) ego.id String name column sib.dat containing survey respondent ID sib.dat long-form sibling dataset (likely produced prep_dhs_sib_histories) sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population weight string name column ego.dat sib.dat containing sampling weight. Defaults wwgt age string name column ego.dat containing age group. Defaults age.cat","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_visibility.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate visibility for each sibship and ego — get_visibility","text":"list three entries: ego_vis - tibble one row per ego ego-specific visibilities ego_vis_agg - tibble summarized adjustment factors sib_res - tibble one row per reported sibling, along tibble row survey respondent (unique value ego.id), number sibs respondent reported frame, including including ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/get_visibility.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"calculate visibility for each sibship and ego — get_visibility","text":"","code":"# TODO write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.age.groups.html","id":null,"dir":"Reference","previous_headings":"","what":"make an age.groups object — make.age.groups","title":"make an age.groups object — make.age.groups","text":"TODO – nice take either widths bins / breaks","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.age.groups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make an age.groups object — make.age.groups","text":"","code":"make.age.groups(start, widths, names)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.age.groups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make an age.groups object — make.age.groups","text":"start first age widths widths subsequent age groups names names age groups","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.age.groups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make an age.groups object — make.age.groups","text":"object (list) widths, names, number age groups, well matrix called template start end age interval. intervals template close left right; eg, exp.start 10 exp.end 20 means [10, 20) terms exact ages (useful later , making individual age schedules based , eg, birth dates)","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.even.age.groups.html","id":null,"dir":"Reference","previous_headings":"","what":"make an age.groups object with evenly-sized intervals — make.even.age.groups","title":"make an age.groups object with evenly-sized intervals — make.even.age.groups","text":"see make.age.groups ","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.even.age.groups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make an age.groups object with evenly-sized intervals — make.even.age.groups","text":"","code":"make.even.age.groups(min.age, max.age, width)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.even.age.groups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make an age.groups object with evenly-sized intervals — make.even.age.groups","text":"min.age first age max.age highest age width width group","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.even.age.groups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make an age.groups object with evenly-sized intervals — make.even.age.groups","text":"see make.age.groups","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.time.periods.html","id":null,"dir":"Reference","previous_headings":"","what":"make a time.periods object — make.time.periods","title":"make a time.periods object — make.time.periods","text":"make time.periods object","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.time.periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make a time.periods object — make.time.periods","text":"","code":"make.time.periods(start, durations, names)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.time.periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make a time.periods object — make.time.periods","text":"start start time interest durations durations subsequent time periods names names time periods","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/make.time.periods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make a time.periods object — make.time.periods","text":"object (list) widths, names, number time periods well matrix called template start end time period. intervals template closed left right; , start 1900 end 1910 means [1900, 1910) terms exact times.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/model_dhs_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Model DHS dataset — model_dhs_dat","title":"Model DHS dataset — model_dhs_dat","text":"simulated dataset structured resemble DHS sibling history data, used demonstrations testing.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/model_dhs_dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Model DHS dataset — model_dhs_dat","text":"data frame DHS-style variables.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":null,"dir":"Reference","previous_headings":"","what":"tabulate occurrences and exposures — occ.exp","title":"tabulate occurrences and exposures — occ.exp","text":"Given variable indicating event happened, time window interested , possibly set covariates, tabulate counts event occurences exposures given time interval. Note careful observations experience event, still count exposure; see example .","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"tabulate occurrences and exposures — occ.exp","text":"","code":"occ.exp(   data,   start.obs,   end.obs,   event,   age.groups,   time.periods,   id.var = NULL,   covars = NULL,   age.offsets = NULL,   time.offsets = NULL,   weights = NULL,   discretize = FALSE,   exp.scale = 1 )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"tabulate occurrences and exposures — occ.exp","text":"data dataset containing events start.obs vector values (one per row data) starting point observation window row, CMC format end.obs vector values (one per row data) ending point observation window row, CMC format event column dataset indicates date event. observations contribute exposure events set value never occur time period; example, -1 age.groups age.groups object time.periods time.periods object id.var variable giving unique rows dataset individual (DEVELOPMENT) covars name covariates occurrences exposures aggregated; defaults NULL, meaning totals computed entire dataset age.offsets NULL, age.periods interpreted relative times (one row). usually birth date time.offsets NULL, time.periods interpreted relative times (one row). useful computing quantities like \"X months interview\", interview happened different times different respondents weights weight apply occurrences exposures; defaults 1 discretize TRUE, turn reported amounts exposure 0/1 exposure exposure; 0 exposure < half time interval spent cell 1 exposure >= half time interval spent cell; thus, sib can contribute exposure one one cell exp.scale amount scale exposure; , example, dates measured months, want measure rates years, 1/12. defaults 1","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"tabulate occurrences and exposures — occ.exp","text":"data frame covariates, age groups, occurences expsoures","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"tabulate occurrences and exposures — occ.exp","text":"TODO write unit tests fill example documentation start code, handle defaults elegantly id.var implemented; might better directly handle multiple events (see ) handle multiple time periods handle multiple events handle GK weights (possibly function) possibly refactor future pass dataset lifelines separate list event dates event date missing? things vary event, eg mother's age child born? better description dates; developed using CMC codes DHS surveys, work interval scale","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/occ.exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"tabulate occurrences and exposures — occ.exp","text":"","code":"if (FALSE) { # \\dontrun{   ## THESE EXAMPLES ARE NOT UPDATED!   ## Please disregard for the time being...    ## RECODE so that observations w/ no births show up   ## in the dataset at least once by giving them a first   ## birth at the (impossible) CMC code of -1. This ensures   ## that they never contribute a birth, but that they   ## still count for exposure.   ##   ## NB: this is a key step. if we don't do this,   ## women who haven't had any births are removed   ## from the dataset, biasing rates upward...    bdata.coded <- bdata   bdata.coded$bdate[ is.na(bdata.coded$bdate) &                     bdata.coded$bnum == \"01\" ] <- -1   bdata.coded <- subset(bdata.coded, ! is.na(bdate) )    ## NO COVARIATES:   ## now use compute.occ.exp to get counts of   ## births and exposure between 1980 and 1990   ## for ages 0 to 60    ## TODO -- need to write this example using new   ##         version    ## WITH COVARIATES:   ##  use compute.occ.exp to get counts of   ## births and exposure by 5-year period   ## between 1970 and 2005,   ## for 5-year age groups [0,5), ..., [60,65)   ## by the covariates   ## urban, highestedlevel, and religion   ## (NOTE: this is just illustrative. we wouldn't recommend   ##  substantively interpreting the results of this example.)    ## TODO -- need to write this example using new   ##         version } # }"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":null,"dir":"Reference","previous_headings":"","what":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"prepare DHS dataset analysis","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"","code":"prep_dhs_sib_histories(   df,   varmap = sibhist_varmap_dhs6,   add_maternal = FALSE,   keep_missing = FALSE,   keep_varmap_only = FALSE,   verbose = TRUE )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"df raw DHS dataset (indvidual recode) varmap see Details add_maternal maternal/pregnancy-related death info added? (Default: FALSE) keep_missing keep reported sibs missing sex survival status? keep_varmap_only keep ego variables mentioned varmap? (Default: FALSE) verbose report detailed summaries?","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"list; see Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"Note dataframe column called 'sex', one added, assume respondents female (sex='f'). want avoid , pass dataframe adding 'sex' column. varmap dataframe columns orig.varname (raw variable name) new.varname (new variable name) sibvar (0/1 column, 1 meaning sibling variable 0 meaning ego variable) row varmap describes variable rename original dataset. respondents, sure include survey (survey id, usually country code plus one digit) caseid (respondent id) wwgt (sampling weight women) psu (primary sampling unit) doi (date interview) siblings, sure include sib.death.date (date sibling's death) sib.alive (whether sib alive) sib.sex (sex sibling, coded 'f' 'm'). default varmap sibhist_varmap_dhs6, included package. Returns list whose entries include ego.dat - dataset information survey respondents sib.dat - dataset information reported siblings summ - one-row tibble summary data","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_dhs_sib_histories.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"prepare a DHS dataset for analysis — prep_dhs_sib_histories","text":"","code":"# TODO - write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":null,"dir":"Reference","previous_headings":"","what":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"prepare dataset nrsimulatr sibling analysis","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"","code":"prep_nrsim_sib_histories(   df,   varmap,   keep_missing = FALSE,   keep_varmap_only = FALSE,   verbose = TRUE )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"df raw dataset (row survey response) varmap see Details; defaults NULL keep_missing keep reported sibs missing sex survival status? keep_varmap_only keep ego variables mentioned varmap? (Default: FALSE) verbose report detailed summaries?","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"list; see Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"function similar prep_dhs_sib_histories, customized work DHS survey data. Note dataframe column called 'sex', one added, assume respondents female (sex='f'). want avoid , pass dataframe adding 'sex' column. varmap dataframe columns orig.varname (raw variable name) new.varname (new variable name) sibvar (0/1 column, 1 meaning sibling variable 0 meaning ego variable) row varmap describes variable rename original dataset. Note MUST include varmap; minimum, needed show columns siblings... respondents, sure include survey (survey id, usually country code plus one digit) caseid (respondent id) wwgt (sampling weight women) psu (primary sampling unit) doi (date interview) siblings, sure include sib.death.date (date sibling's death) sib.alive (whether sib alive) sib.sex (sex sibling, coded 'f' 'm'). Returns list whose entries include ego.dat - dataset information survey respondents sib.dat - dataset information reported siblings summ - one-row tibble summary data","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/prep_nrsim_sib_histories.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"prepare a dataset from nrsimulatr for sibling analysis — prep_nrsim_sib_histories","text":"","code":"# TODO - write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":null,"dir":"Reference","previous_headings":"","what":"get calculate internal consistency checks for sibling reports — sib_ic_checks","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"get calculate internal consistency checks sibling reports","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"","code":"sib_ic_checks(   esc.dat,   ego.dat,   ego.id,   sib.id,   sib.frame.indicator,   sib.cell.vars,   ego.cell.vars,   boot.weights )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"esc.dat ego X sibling X cell dataset (see get_esc_reports) ego.dat ego dataset, containing one row survey respondent ego.id String name column esc.dat containing survey respondent ID sib.id String name column esc.dat containing unique sibling ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population sib.cell.vars see Details ego.cell.vars see Details boot.weights Dataframe bootstrap resampled weights. See Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"list two entries: ic.summ, summarized results; ic.boot.ests full results bootstrap rep","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"sib.cell.vars ego.cell.vars arguments vector Strings containing names columns esc.dat identifying cells group reports (typically age sex, possibly variables). Note , unlike cell.vars argument get_ec_reports, function sib.cell.vars ego.cell.vars MUST age variable listed FIRST. goal get_ic_reports find cell sibling time interview, meaning oldest age group sibling contributed exposure. boot.weights assumed column named whatever ego.id , series columns named boot_weight_1, ..., boot_weight_M.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks","text":"","code":"# TODO write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":null,"dir":"Reference","previous_headings":"","what":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"get calculate internal consistency checks sibling reports","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"","code":"sib_ic_checks_OLD(   esc.dat,   ego.dat,   ego.id,   sib.id,   sib.frame.indicator,   sib.cell.vars,   ego.cell.vars,   boot.weights )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"esc.dat ego X sibling X cell dataset (see get_esc_reports) ego.dat ego dataset, containing one row survey respondent ego.id String name column esc.dat containing survey respondent ID sib.id String name column esc.dat containing unique sibling ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population sib.cell.vars see Details ego.cell.vars see Details boot.weights Dataframe bootstrap resampled weights. See Details","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"tibble row reported sibling frame population, sibling's cell info, cell info survey respondent reported sibling","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"sib.cell.vars ego.cell.vars arguments vector Strings containing names columns esc.dat identifying cells group reports (typically age sex, possibly variables). Note , unlike cell.vars argument get_ec_reports, function sib.cell.vars ego.cell.vars MUST age variable listed FIRST. goal get_ic_reports find cell sibling time interview, meaning oldest age group sibling contributed exposure. boot.weights assumed column named whatever ego.id , series columns named boot_weight_1, ..., boot_weight_M.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sib_ic_checks_OLD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get calculate internal consistency checks for sibling reports — sib_ic_checks_OLD","text":"","code":"# TODO write example code"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs2.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 2 — sibhist_varmap_dhs2","title":"DHS sibling history variable map for DHS phase 2 — sibhist_varmap_dhs2","text":"data frame mapping variable names used DHS phase 2 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 2 — sibhist_varmap_dhs2","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs3.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 3 — sibhist_varmap_dhs3","title":"DHS sibling history variable map for DHS phase 3 — sibhist_varmap_dhs3","text":"data frame mapping variable names used DHS phase 3 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs3.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 3 — sibhist_varmap_dhs3","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs4.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 4 — sibhist_varmap_dhs4","title":"DHS sibling history variable map for DHS phase 4 — sibhist_varmap_dhs4","text":"data frame mapping variable names used DHS phase 4 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs4.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 4 — sibhist_varmap_dhs4","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs5.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 5 — sibhist_varmap_dhs5","title":"DHS sibling history variable map for DHS phase 5 — sibhist_varmap_dhs5","text":"data frame mapping variable names used DHS phase 5 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs5.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 5 — sibhist_varmap_dhs5","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs6.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 6 — sibhist_varmap_dhs6","title":"DHS sibling history variable map for DHS phase 6 — sibhist_varmap_dhs6","text":"data frame mapping variable names used DHS phase 6 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs6.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 6 — sibhist_varmap_dhs6","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs7.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 7 — sibhist_varmap_dhs7","title":"DHS sibling history variable map for DHS phase 7 — sibhist_varmap_dhs7","text":"data frame mapping variable names used DHS phase 7 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs7.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 7 — sibhist_varmap_dhs7","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs8.html","id":null,"dir":"Reference","previous_headings":"","what":"DHS sibling history variable map for DHS phase 8 — sibhist_varmap_dhs8","title":"DHS sibling history variable map for DHS phase 8 — sibhist_varmap_dhs8","text":"data frame mapping variable names used DHS phase 8 sibling history modules standardized names used package.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibhist_varmap_dhs8.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DHS sibling history variable map for DHS phase 8 — sibhist_varmap_dhs8","text":"data frame columns original standardized variable names.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_estimator.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate death rates from sibling history data — sibling_estimator","title":"Estimate death rates from sibling history data — sibling_estimator","text":"Estimate death rates sibling history data","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_estimator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate death rates from sibling history data — sibling_estimator","text":"","code":"sibling_estimator(   sib.dat,   ego.id,   sib.id,   sib.frame.indicator,   sib.sex = \"sex\",   cell.config,   weights,   boot.weights = NULL,   return.boot = FALSE,   discretize.exp = FALSE )"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_estimator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate death rates from sibling history data — sibling_estimator","text":"sib.dat long-form sibling history dataset (likely produced prep_dhs_sib_histories) ego.id String name column sib.dat ID survey respondent sib.id String name column sib.dat sibling ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population sib.sex String name fo column sib.dat sibling's sex cell.config object containing configuration cells; see TODO information weights String name column sib.dat sampling weight boot.weights Optional dataframe bootstrap resampled weights. See Details info. return.boot TRUE, boot.weights specified, return bootstrap estimate discretize.exp Boolean whether expsoure discretized. yet implemented.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_estimator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate death rates from sibling history data — sibling_estimator","text":"list two entries: asdr.ind, individual visibility asdr estimates; asdr.agg, aggregate visibility asdr estimates","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_estimator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate death rates from sibling history data — sibling_estimator","text":"want estimated sampling variances, can pass data frame boot.weights. boot.weights assumed column named whatever ego.id , series columns named boot_weight_1, ..., boot_weight_M.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_summ.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate summary statistics for siblings in a given time window — sibling_summ","title":"calculate summary statistics for siblings in a given time window — sibling_summ","text":"calculate summary statistics siblings given time window","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_summ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate summary statistics for siblings in a given time window — sibling_summ","text":"","code":"sibling_summ(sib.dat, ego.id, sib.id, sib.frame.indicator, cell.config)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_summ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate summary statistics for siblings in a given time window — sibling_summ","text":"sib.dat long-form sibling dataset (likely produced prep_dhs_sib_histories) ego.id String name column sib.dat containing survey respondent ID sib.id String name column sib.dat sibling ID sib.frame.indicator String name column sib.dat containing 0/1 coded variable indicating whether sib frame population cell.config object containing configuration cells; see cell_config information","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/sibling_summ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate summary statistics for siblings in a given time window — sibling_summ","text":"one-row tibble two columns: num_sibs number sibs contribute exposure time window; num_deaths, number reported sibling deaths time window","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/window_intersect.html","id":null,"dir":"Reference","previous_headings":"","what":"window_intersect — window_intersect","title":"window_intersect — window_intersect","text":"given two intervals, figure intersection first second NOTE intervals treated half-open (start,finish] event happens exactly time b counted (,b] (b, c]","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/window_intersect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"window_intersect — window_intersect","text":"","code":"window_intersect(a, b)"},{"path":"http://dennisfeehan.org/siblingsurvival/reference/window_intersect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"window_intersect — window_intersect","text":"first window; , use three components (start, finish, event) b second window; , use start finish time, ignore events","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/window_intersect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"window_intersect — window_intersect","text":"window containing exposure events takes place time given b; also, event takes place b, included","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/reference/window_intersect.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"window_intersect — window_intersect","text":"TODO - write detailed description","code":""},{"path":[]},{"path":"http://dennisfeehan.org/siblingsurvival/news/index.html","id":"new-features-0-3-0","dir":"Changelog","previous_headings":"","what":"New features","title":"siblingsurvival 0.3.0","text":"Added add_maternal_deaths() classify sibling deaths pregnancy-related maternal based DHS coding variables (sib.died.pregnant, sib.time.delivery.death, sib.died.accident). Added aggregate_maternal_estimates() aggregate age-specific maternal mortality estimates across age groups using respondent age distribution weights. Supports point estimates bootstrap confidence intervals. Added get_ego_age_distn() (internal) compute weighted age distribution survey respondents, used reference population aggregation. Added prep_nrsim_sib_histories() prepare non-DHS (NR-SIM style) sibling history data, alongside existing prep_dhs_sib_histories(). Improved bootstrap performance sibling_estimator() via matrix multiplication (get_boot_ests_matrix()), replacing wide-dataframe approach achieving substantial speed-ups large bootstrap replicate counts.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/news/index.html","id":"bug-fixes-0-3-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"siblingsurvival 0.3.0","text":"Fixed aggregate_maternal_estimates(), accidentally referencing package-level example objects (ex.ego, ex.sib) instead ego.dat sib.dat arguments passed caller. Fixed attributes..long(): replaced defunct dplyr::select_(), mutate_(), filter_() (deprecated dplyr 0.7, now defunct) modern equivalents (select(all_of(...)), mutate(across(...)), filter()). Removed lazyeval package Imports. unblocked devtools::build(), failing building vignettes.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/news/index.html","id":"tests-0-3-0","dir":"Changelog","previous_headings":"","what":"Tests","title":"siblingsurvival 0.3.0","text":"Added tests/testthat/test_maternal.R tests covering add_maternal_deaths(), get_ego_age_distn(), aggregate_maternal_estimates() (including bootstrap paths). Added tests/testthat/test_prep_dhs_sib_histories.R smoke tests prep_dhs_sib_histories().","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/news/index.html","id":"repository-0-3-0","dir":"Changelog","previous_headings":"","what":"Repository","title":"siblingsurvival 0.3.0","text":"Renamed default branch master main.","code":""},{"path":"http://dennisfeehan.org/siblingsurvival/news/index.html","id":"siblingsurvival-010","dir":"Changelog","previous_headings":"","what":"siblingsurvival 0.1.0","title":"siblingsurvival 0.1.0","text":"Added NEWS.md file track changes package. Created website package using pkgdown","code":""}]
